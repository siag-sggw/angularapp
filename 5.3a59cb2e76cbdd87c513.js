(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"y+Kn":function(e,t,o){"use strict";o.r(t);var r=o("wqd5"),a=o("xDkM"),n=o("pzT4"),i=o("UJwI"),l=o("VjCp"),s=o("6kCM"),c=o("SF0J"),h=o("cosN"),d=[{initialAttr:function(){return{opacity:0}},finalAttr:function(){return{opacity:1}}}],g={"initial.dataset.entities":function(){return{"path.appearing":()=>(d[0].slot="plot",d),"path.updating":e=>[{finalAttr:function(){return e.finalAttr}}],"labelConnectors.appearing":()=>(d[0].slot="final",d),"labelConnectors.updating":null,"entityLabel.appearing":()=>[{initialAttr:{opacity:0},finalAttr:{opacity:1},slot:"final"}],"*":null}},"initial.dataset.markers":function(){return{markers:null,"markerItem.appearing":()=>(d[0].slot="final",d),"markerItem.updating":e=>[{finalAttr:function(){return e.finalAttr}}]}},"initial.group.mapGroup":function(){return{"group.appearing":e=>[{initialAttr:function(){return Object.assign({opacity:0},e.attr)},finalAttr:function(){return e.attr},slot:"plot"}],"group.updating":e=>[{initialAttr:function(){return Object.assign({opacity:0},e.attr)},finalAttr:function(){return e.attr},slot:"plot"}],"*":null}}},p=o("B/xI");let b,u=Object(h.b)("redraphael","plugin"),f=window.navigator.userAgent,m=/msie/i.test(f)&&!window.opera,v=",",y="",C="top",x="bottom",O="right",k="left",w="middle",F="center",j="crisp",A=window.Math,I=A.min,L=A.max,S=/stroke/gi,E=/AppleWebKit/.test(f),_=A.ceil,P=function(e,t){let o=t?Object(s.W)(e.FCcolor,t,!1,!0):{FCcolor:e};return o.toString=s.Vb,o},T=function(e,t){let o,r={};if(t=t||1,!e||"object"!=typeof e)return r;for(o in e)S.test(o)||("stroke-width"===o?(r[o]=+e[o]/t,E&&(r[o]=r[o]&&_(r[o])||0)):r[o]=e[o]);return r},R={right:function(){return arguments[1]},left:function(e,t){return e-t},center:function(e,t){return 2*I(t,e-t)}},M={top:function(){return arguments[1]},middle:function(e,t){return 2*I(t,e-t)},bottom:function(e,t){return e-t}},B=function(e){let t,o=e&&e.length||0,r={};for(;o--;)(t=e[o]).id!==b&&(r[t.id.toLowerCase()]=t);return r};var K,D,V,G,N,W,H,z,X,Y,U;Object(h.a)({name:"mapsAnimation",type:"animationRule",extension:g}),K=u,N=window.parseFloat,W=K._createNode,H=K._setFillAndStroke,z=K.el.constructor,X={Q:"L",Z:"X",q:"l",z:"x",",":" "},Y=/,?([achlmqrstvxz]),?/gi,U=function(){return this.join(",").replace(Y,D)},K.svg?(D="$1",V=function(){var e=K.is(arguments[0],"array")?arguments[0]:Array.prototype.slice.call(arguments);e?"string"==typeof e?e=e.replace(Y,D):e.toString=U:e="M0,0",this.node.setAttribute("d",e.toString())},K._engine.litepath=function(e,t,o,r,a){var n,i=W("path");return(r||t).canvas.appendChild(i),(n=new z(i,t,r)).type="litepath",n.id=i.raphaelid=K._oid++,i.raphael=!0,H(n,a||{fill:"none",stroke:"#000"}),n},K._getPath.litepath=function(e){return K.parsePathString(e.node.getAttribute("d"))}):K.vml&&(D=function(e,t){return X[t]||t},G=function(){var e=this;return e._transform.apply(e,arguments),e._.bcoord&&(e.node.coordsize=e._.bcoord),e},V=function(e){return e?"string"==typeof e?e=e.replace(Y,D):e.toString=U:e="M0,0",this.node.path=e,this},K._engine.litepath=function(e,t,o,r,a){var n,i=W("shape"),l=i.style,s=new z(i,t,r);return l.cssText="position:absolute;left:0;top:0;width:21600px;height:21600px;",o=N(o),isNaN(o)?i.coordsize="21600 21600":(s._.bzoom=o,l.width="1px",l.height="1px",i.coordsize=s._.bcoord=o+" "+o),i.coordorigin=t.coordorigin,s.type="litepath",s.id=i.raphaelid=K._oid++,i.raphael=!0,s._transform=s.transform,s.transform=G,K._setFillAndStroke(s,a||{fill:"none",stroke:"#000"}),(r||t).canvas.appendChild(i),(n=W("skew")).on=!0,i.appendChild(n),s.skew=n,s},K._getPath.litepath=function(e){return K.parsePathString(e.node.path||"")}),K.fn.litepath=function(e,t,o){var r,a,n;return"object"==typeof e&&e.constructor!==z&&(r=e,a=(e=e.litepath).zoom,o=e.group),t&&t.constructor===z?(o=t,a=void 0):a=t,e&&e.constructor===z&&(o=e,e=""),(n=K._engine.litepath(e,this,a,o,r)).ca.litepath=V,e&&n.attr("litepath",K.is(e,"array")?[e]:e),this.__set__&&this.__set__.push(n),this._elementsById[n.id]=n};class J extends a.a{constructor(){super(),this.components={}}getName(){return"entities"}getType(){return"dataset"}configureAttributes(e){if(!e)return;this.JSONData={data:e};let t,o,r,a,n,i,l,c,h=this,d=h.getFromEnv("chart").jsonData,g=h.config,p=d.map||d.chart,b=[],u=h.getFromEnv("colorManager"),f=d.entitydef||[];for(n in!g.attachEvent&&u&&(h.addExtEventListener("legendUpdate",function(){if("legend"===(c=arguments[1]).component)h.legendInteractivity(c.legendItem,c.colorObj);else for(i=(b=c.maxMinArray).length,l=0;l<i;l++)h.updateEntityColors(b[l].min,b[l].max)},u),g.attachEvent=!0),t=h.JSONData=d.data&&d.data[0]&&d.data[0].data?d.data[0].data||[]:d.data||[],g.useSNameAsId=Object(s.Kb)(p.usesnameasid,0),this._redefineEntities(f),o=h.components.data,g.showTooltip=Object(s.Kb)(p.showtooltip,1),g.showHoverEffect=Object(s.Kb)(p.showhovereffect,0),t=B(t),h.calculateDataLimits(),d.colorrange||h.detachChild(h.getChildren("colorRange")&&h.getChildren("colorRange")[0].getId()),o)this._configureEntity(n,a=o[n],(r=t[n])?Object(s.xb)(J._sanitizeEntityOptions(Object(s.W)({},r)),a.config):a.config)}updateEntityColors(e,t){let o,r,a,n,i,l,s=this.components.data,c=this.getFromEnv("chart"),h={"fill-opacity":0};for(n in s)l={"fill-opacity":(i=(r=(o=s[n]).config).alphaArr||[])[0]/100||1},(a=r.cleanValue)<e||a>t?(J.setCustomAttrs(o,h,c),o.hidden=!0):(o.hidden=!1,J.setCustomAttrs(o,l,c))}legendInteractivity(e,t){let o,r,a,n,i,l,s=this,c=s.getFromEnv("chart"),h=s.components.data,d=e.config,g=e.hasState("hidden"),p=s.getFromEnv("colorManager"),b={},u={"fill-opacity":0};for(o in c.getFromEnv("animationManager").setAnimationState("legendInteraction"),h)h.hasOwnProperty(o)&&(l=p.getColorObj(a=(d=(r=h[o]).config).cleanValue),b["fill-opacity"]=(n=d.visibleEntityAttr)["fill-opacity"],i=g?b:u,t.code===(!l.outOfRange&&l.code)&&(r.hidden=!g,J.setCustomAttrs(r,i,c),g?e&&e.removeLegendState("hidden"):e.setLegendState("hidden")))}static setCustomAttrs(e,t){let o,r;e&&(r=(o=e.graphics).outlines).attr(t)}calculateDataLimits(){let e,t,o,r,a=this.getFromEnv("chart"),n=this.config,i=a.jsonData.data||[],l=this.getFromEnv("number-formatter"),s=1/0,c=-1/0;for(r=0,o=i.length;r<o;r++)e=l.getCleanValue(t=i[r].value),s=I(s,e),c=L(c,e);n.max=c,n.min=s}_configureEntity(e,t,o){let r,a,n,i,l,c,h,d,g,p,u,f,m,C,x,O,k,j,A,I,L,S,E=this,_=E.getFromEnv("chart"),T=E.config,R=this.getFromEnv("number-formatter"),M=_.config.entityOpts,B=t.config,K=t.labelConfig,D=o.value,V=B.cleanValue=R.getCleanValue(D),G=B.formattedValue=V===b?b:R.dataLabels(V),N=Object(s.Kb)(o.showtooltip,M.showTooltip),W=this._getDefaultTooltip(t,o,E),H={formattedValue:G,sName:o.shortLabel,lName:o.label},z=M.dataLabels.style,X=B.toolText=N?Object(s.Hb)(Object(s.Ib)(Object(s.Gb)(Object(s.Ib)(o.tooltext,M.tooltext,W),[1,2,7,38,39],H,o))):y,Y=B.borderColor=Object(s.Ib)(o.bordercolor,M.borderColor),U=B.borderAlpha=Object(s.Ib)(o.borderalpha,M.borderAlpha),J=B.borderThickness=Object(s.Kb)(o.borderthickness,M.borderThickness),q=M.hoverOnNull,Z=B.useHoverColor=Object(s.Kb)(o.showhovereffect,o.usehovercolor,q?M.showHoverEffect:isNaN(D)?0:M.showHoverEffect),$=B.labelAlignment,Q=E.getFromEnv("colorManager");if(t.hidden=!1,B.showLabel=Object(s.Kb)(o.showlabel,M.showLabels),B.labelPadding=Object(s.Kb)(o.labelpadding,M.labelPadding),B.fontFamily=Object(s.Ib)(o.font,z.fontFamily),B.fontSize=Object(s.Kb)(parseInt(o.fontsize,10),parseInt(z.fontSize,10)),B.fontBold=Object(s.Kb)(o.fontbold,0),B.fontColor=Object(s.Ib)(o.fontcolor,z.color),B.connectorColor=Object(s.Ib)(o.labelconnectorcolor,M.connectorColor),B.connectorAlpha=Object(s.Ib)(o.labelconnectoralpha,M.connectorAlpha),B.hoverBorderThickness=Object(s.Kb)(o.borderhoverthickness,o.hoverborderthickness,M.hoverBorderThickness),B.hoverBorderColor=Object(s.Ib)(o.borderhovercolor,o.hoverbordercolor,M.hoverBorderColor,B.borderColor),B.hoverBorderAlpha=Object(s.Ib)(o.borderhoveralpha,o.hoverborderalpha,M.hoverBorderAlpha,B.borderAlpha),B.connectorThickness=Object(s.Kb)(o.labelconnectorthickness,M.connectorThickness),B.origConnectorThickness=B.connectorThickness,B.borderThickness=J,B.link=o.link,B.isVisible=!0,B.id=e,B.originalId=o.origId,null!==V&&(r=Q&&Q.getColor(V))&&!r.outOfRange&&(O=r.code,r.oriAlpha!==b&&(k=r.oriAlpha+"")),Object(s.Ib)(o.color,o.alpha,o.angle,o.ratio)===b?(C=P({color:Object(s.Ib)(O,M.fillColor),alpha:Object(s.Ib)(k,M.fillAlpha),angle:Object(s.Ib)(M.fillAngle),ratio:Object(s.Ib)(M.fillRatio)}),m=P({color:Object(s.Ib)(M.nullEntityColor),alpha:Object(s.Ib)(M.nullEntityAlpha),angle:Object(s.Ib)(M.nullEntityAngle),ratio:Object(s.Ib)(M.nullEntityRatio)}),l=(g=null===V?m:C).FCcolor.color,c=g.FCcolor.alpha,h=g.FCcolor.angle,d=g.FCcolor.ratio):(l=Object(s.Ib)(o.color,O,M.fillColor),c=Object(s.Ib)(o.alpha,k,M.fillAlpha),h=Object(s.Ib)(o.angle,M.fillAngle),d=Object(s.Ib)(o.ratio,M.fillRatio),g=P({color:l,alpha:c,angle:h,ratio:d})),X===y&&(T.showTooltip=0),B.visibleEntityAttr={stroke:Object(s.P)(Y,U),fill:(B.fillColor=g).toString(),"fill-opacity":c/100},S=c.split(v),B.alphaArr=S,Z&&(Object(s.Ib)(o.fillhovercolor,o.fillhoveralpha,o.fillhoverangle,o.fillhoverratio,o.hoverfillcolor,o.hoverfillalpha,o.hoverfillratio,o.hoverfillangle)===b?(!M.hoverColorObject&&(M.hoverColorObject=P({color:M.hoverFillColor,alpha:M.hoverFillAlpha,angle:M.hoverFillAngle,ratio:M.hoverFillRatio})),x=M.hoverColorObject):(l=Object(s.Ib)(o.fillhovercolor,o.hoverfillcolor,M.hoverFillColor),c=Object(s.Ib)(o.fillhoveralpha,o.hoverfillalpha,M.hoverFillAlpha),h=Object(s.Ib)(o.fillhoverangle,o.hoverfillangle,M.hoverFillAngle),d=Object(s.Ib)(o.fillhoverratio,o.hoverfillratio,M.hoverFillRatio),x=P({color:l,alpha:c,angle:h,ratio:d})),B.hoverColor=x),K||(K=t.labelConfig={}),p=B.fontColor,u=B.fontFamily,f=B.fontBold,X=B.toolText,a=B.link,$?(n=$[0],i=$[1]):(n=F,i=w),K.align=n,K.vAlign=i,K.bgColor=y,K.borderColor=y,K.fontColor=p,K.fontFamily=u,K.fontBold=f,K.toolText=X,K.link=a,"object"==typeof B.options)for(j=B.entityLabels=B.entityLabels||[],L=(I=B.labels||[]).length;L--;)j[L]||(j[L]={config:{}}),($=I[L].labelAlignment)?(n=$[0],i=$[1]):(n=F,i=w),(K=j[L].config).align=n,K.vAlign=i,K.displayValue=E.getDisplayValue(t,I[L],B.options.isDataEnabled,!L,o),K.bgColor=y,K.borderColor=y,K.toolText=X,K.align=n,K.vAlign=i,K.bgColor=y,K.borderColor=y,K.fontColor=p,K.fontFamily=u,K.fontBold=f,K.toolText=X;else K.displayValue=E.getDisplayValue(t,A={shortText:B.shortLabel,text:B.label},!0,!0,o)}getDisplayValue(e,t,o,r,a){let n,i=this.getFromEnv("chart").config.entityOpts,l=e.config,c=l.cleanValue,h=l.formattedValue,d=i.labelSepChar;return o?r&&void 0!==a.displayvalue?n=a.displayvalue:(n=Object(s.Ib)(i.includeNameInLabels?i.useShortName?t.shortText:t.text:""),i.includeValueInLabels&&null!==c&&(n=n===b?h:n+d+h)):n=l.label,n}static _sanitizeEntityOptions(e){return delete e.outlines,delete e.label,delete e.shortlabel,delete e.labelposition,delete e.labelalignment,delete e.labelconnectors,e}_redefineEntities(e){let t,o,r,a,n,i,l,c,h,d,g,p,b=this,u=b.config,f={},m={},v=b.getFromEnv("chart").config.entities,y=u.useSNameAsId,C=0;for(t=e.length;t--;)if(r=(o=e[t]).internalid,a=o.newid?o.newid:r,n=o.sname,i=o.lname,p=v[r],r=Object(s.Xb)(r),a=(a=Object(s.Xb)(a))&&a.toLowerCase(),p){for(g in f[a]=c={origId:r},m[r]=!0,p)c[g]=p[g];c.shortLabel=n||p.shortLabel,c.label=i||p.label,c.showhovereffect=o.showhovereffect,c.fillhovercolor=o.fillhovercolor,c.fillhoveralpha=o.fillhoveralpha,c.fillhoverangle=o.fillhoverangle,c.fillhoverratio=o.fillhoverratio,c.borderhoverthickness=o.borderhoverthickness}for(l in(d=b.components.data)||(d=b.components.data={}),f)d[l=l.toLowerCase()]||(d[l]={config:{}}),d[l].config=f[l],C+=1;for(l in h=d,v)if(c=v[l],!m[l=Object(s.Xb)(l)]){for(g in y?(!(p=h[c.shortLabel.toLowerCase()])&&(p=h[c.shortLabel.toLowerCase()]={}),p.config={},p.origId=c.shortLabel):(!(p=h[l.toLowerCase()])&&(p=h[l.toLowerCase()]={}),p.config={},p.config.origId=l),c)p.config[g]=c[g];C+=1}u.entityCount=C}draw(){let e,t=this,o=t.config,r=t.getFromEnv("chart"),a=s.tb?200:10;t.createContainer(),this.config.ready=!1,o.BATCH_SIZE=a,o.labelBatchSize=s.tb?200:20,(e=this._batchRender())(0),r.config.entityFlag=!0,r.checkComplete()}_batchRender(){let e,t,o,r,a,n=this,i=n.config,l=n.getFromEnv("chart").config.entities.firstEntity,s=n.components.data,c=i.BATCH_SIZE,h=i.entityKeys=l?n._getKeys(l,s):Object.keys(s),d=i.entityLength=h.length,g=function(i){for(e=i,o=0;h[e]!==b;)if(a=n.drawEntity(t=s[h[e]],c),o+=a,t.config.drawn&&((r=e===d-1?t:s[h[e-1]])&&(r.config.drawn=!1,r.config.outlineStartIndex=b),e++),o>=c){n.addJob("entityDraw",g.bind(this,e),p.b.entitydraw);break}e===d&&(n._addEventListenersToEntities(0),n.initComplete())};return g}_addEventListenersToEntities(e){let t,o,r,a,n=this,i=n.components.data,l=n.config,s=l.BATCH_SIZE,c=l.entityKeys,h=l.entityLength,d=0;for(t=e;t<h;t++)if((r=(a=(o=i[c[t]]).config).options)&&!1===r.isDataEnabled||n.addMouseGestures(o),++d===s){n.addJob("_addEventListenersToEntities",n._addEventListenersToEntities.bind(this,t),p.b.entitydraw);break}}static _getKeys(e,t){let o=[e],r=e;for(;t[r];)o.push(r=t[r].nextId);return o}_getDefaultTooltip(e,t){let o,r,a=e.config.cleanValue,n=e.config.formattedValue,i=this.getFromEnv("chart").config.entityOpts;if("object"==typeof e.config.options){if(!(r=t.labels&&t.labels[0]))return b;o=(i.useSNameInTooltip?r.shortText:r.text)+(null===a?y:i.tooltipSepChar+n)}else o=(i.useSNameInTooltip?t.shortLabel:t.label)+(null===a?y:i.tooltipSepChar+n);return o}drawEntity(e,t){let o,r,a,n,i,l,c,h,d,g=this,p=g.getFromEnv("chart"),u=p.getFromEnv("animationManager"),f=e.config,v=s.tb||!m?"litepath":"path",y=p.config.entityOpts,C=f.outlines,x=g.getFromEnv("toolTipController"),O=this.getLinkedParent().getChildContainer("plot"),k=this.getLinkedParent().getChildContainer("plotShadow"),w=f.toolText,F=y.shadow,j=[],A={};if(g._configureEntityDrawingParams(e),a=(f=e.config).visibleEntityAttr,d=f.shadowOptions,o=f.outlineStartIndex===b?C.length:f.outlineStartIndex,e.graphics||(e.graphics={}),c=0,j=f.outlinePath||(f.outlinePath=[]),h=f.customStrokeWidthModifier,"object"==typeof f.options){for(;o--;)if(j=C[o].outline,n=!0===f.options.isDataEnabled?a:Object(s.W)(Object(s.W)({},a),T(C[o].style,h)),(i=e.graphics.outlines)||(i=e.graphics.outlines=[]),i[o]||(i[o]={}),l=i[o].outline,n[v]=j,(l=i[o].outline=u.setAnimation({el:v,container:O,attr:n,component:g,label:"path"})).shadow(!!F&&d,k),x.enableToolTip(l,w),c++,f.outlineStartIndex=o,c===t)return c;return f.drawn=!0,c}for(;o--;)if(j=(r=C[o]).concat(j),c++,f.outlineStartIndex=o,c===t)return f.outlinePath=j,c;return e.graphics.outlines||(a[v]=j),Object.assign(A,a,e.hidden&&{"fill-opacity":0}||{}),e.graphics.outlines=u.setAnimation({el:e.graphics.outlines||v,container:O,attr:A,component:g,label:"path"}),f.drawn=!0,f.outlineStartIndex=0,f.outlinePath=[],e.graphics.outlines.shadow(!!F&&d,k),x.enableToolTip(e.graphics.outlines,w),c}_configureEntityDrawingParams(e){let t,o=this.getFromEnv("chart"),r=e.config,a=o.config.scalingParams,n=!m||s.tb,i=a.scaleFactor,l=a.strokeWidth,c=(n?o.baseScaleFactor:1)*l,h=1===o.config.entityOpts.scaleBorder,d=r.borderThickness,g=r.origConnectorThickness,p=r.hoverBorderThickness,b=r.visibleEntityAttr,u=b["fill-opacity"];r.shadowOptions={scalefactor:[i,i*o.config.baseScaleFactor],opacity:L.apply(A,r.alphaArr)/100,useFilter:0},r.fillOpacity=e.hidden?0:u,n?(d=r.entityBorderThickness=h?d*c:d/i,g/=i,t=h?i:a.sFactor,p&&(p=r.hoverBorderThickness=h?p*c:p/i)):(d=h?d*l:d,t=h?a.scaleFactor:o.baseScaleFactor),r.entityBorderThickness=d,r.connectorThickness=g,r.customStrokeWidthModifier=t,b["stroke-width"]=d,b.transform=s.tb||!m?"":a.transformStr}drawLabels(e){let t,o,r,a,n=this,i=e,l=n.getFromEnv("chart"),s=n.config,h=s.labelBatchSize,d=s.entityLength,g=[],p=l.getChildContainer("upperAnnotationGroup"),b=0,u=n.getChildren("mapLabelAnnotations")&&n.getChildren("mapLabelAnnotations")[b],f=0,m=0,v=l.config.annotationConfig;for(t in u||(a=new c.a,n.attachChild(a,"mapLabelAnnotations"),(u=n.getChildren("mapLabelAnnotations")[b]).addCustomGroup(p)),u.destroy(),u._renderer&&(u._renderer=null),v.showbelow=0,i){if(n.drawLabel(i[t],g),++f===h){for(o=0;o<g.length;o++)g[o].animationLabel="entityLabel";for(r=u.addGroup(Object.assign(v,{id:"entityLabels"+b,items:g,animationLabel:"entityLabelGroup"}),n),o=0;o<r.items.length;o++)r.items[o].addEventListener("fc-mouseover",g[o].onmouseover),r.items[o].addEventListener("fc-mouseout",g[o].onmouseout),r.items[o].addEventListener("fc-click",g[o].onclick);b++,(u=n.getChildren("mapLabelAnnotations")&&n.getChildren("mapLabelAnnotations")[b])||(a=new c.a,n.attachChild(a,"mapLabelAnnotations"),(u=n.getChildren("mapLabelAnnotations")[b]).addCustomGroup(p)),u.destroy(),u._renderer&&(u._renderer=null),f=0,g=[]}else if(m==d-1){for(o=0;o<g.length;o++)g[o].animationLabel="entityLabel";for(r=u.addGroup(Object.assign(v,{id:"entityLabels"+b,items:g,animationLabel:"entityLabelGroup"}),n),o=0;o<r.items.length;o++)r.items[o].addEventListener("fc-mouseover",g[o].onmouseover),r.items[o].addEventListener("fc-mouseout",g[o].onmouseout),r.items[o].addEventListener("fc-click",g[o].onclick)}m++}n.drawLabelConnFn(0)}drawLabelConnFn(e){let t,o,r,a,n,i=this,l=i.config,s=i.components.data,c=l.BATCH_SIZE,h=l.entityKeys,d=h.length,g=0;for(o=e;o<d;o++){if("object"==typeof(a=(n=s[h[o]]).config).options)for(t=(r=a.labels)&&r.length||0;t--;)r[t].labelConnectors&&(i.drawLabelConnectors(n,r[t].labelConnectors,i),g++);else a.labelConnectors&&(i.drawLabelConnectors(n,a.labelConnectors,i),g++);if(g===c){i.addJob("drawLabelConnectors",i.drawLabelConnFn.bind(this,o),p.b.entitydraw);break}}}_getLabelObject(e,t,o){let r,a,n,i,l,s,c,h,d,g,p,u,f=this,m=f.getFromEnv("chart"),v=e.config,y=m.config.scalingParams,j=e.graphics&&e.graphics.outlines,A=v.fontSize,I=v.labelPadding;return t===b?(r=e.labelConfig,a=v.labelPosition,n=v.labelAlignment):(i=(r=(u=(v.entityLabels||[])[t]).config).style=(p=(v.labels||[])[t]).style,a=p.labelPosition,n=p.labelAlignment),a?(l=a[0],s=a[1]):(l=(c=j.getBBox()).x+c.width/2,s=c.y+c.height/2),n?((h=n[0])===O?l-=I:h===k&&(l+=I),(d=n[1])===C?s-=I:d===x&&(s+=I)):(h=F,d=w),g=parseFloat(A)/y.sFactor,!o&&i&&(i.color&&(r.fontColor=i.color),i["font-size"]&&(g=parseFloat(i["font-size"])/y.sFactor),i["font-family"]&&(r.fontFamily=i["font-family"]),i["font-weight"]!==b&&(r.fontBold="bold"===i["font-weight"])),r.x=l.toString(),r.y=s.toString(),r.wrap=1,r.type="text",r.fontSize=g,{x:l.toString(),y:s.toString(),wrapwidth:R[h](void 0,l+void 0)-I,wrapheight:M[d](void 0,s+void 0)-I,wrap:1,type:"text",align:r.align,valign:r.vAlign,text:r.displayValue,tooltext:r.toolText,css:r.link!==b&&{cursor:"pointer",_cursor:"hand"},bgcolor:r.bgColor,bordercolor:r.borderColor,fillcolor:r.fontColor,fontsize:r.fontSize,font:r.fontFamily,bold:r.fontBold,onclick:function(t){let o,r,a=e.graphics.outlines;if(a instanceof Array)for(o=0,r=a.length;o<r;o++)f.entityClick(a[o].outline,t);else f.entityClick(a,t)},onmouseover:function(t){let o,r,a=e.graphics.outlines;if(a instanceof Array)for(o=0,r=a.length;o<r;o++)f.entityRollOver(a[o].outline,t);else f.entityRollOver(a,t)},onmouseout:function(t){let o,r,a=e.graphics.outlines;if(a instanceof Array)for(o=0,r=a.length;o<r;o++)f.entityRollOut(a[o].outline,t);else f.entityRollOut(a,t)},ontouchstart:function(t){let o,r,a=e.graphics.outlines;if(a instanceof Array)for(o=0,r=a.length;o<r;o++)f.entityRollOver(a[o].outline,t);else f.entityRollOver(a,t);f.entityRollOver(a,t)}}}drawLabel(e,t){let o,r,a,n=this,i=e.config;if(i.showLabel)if("object"==typeof i.options)for(r=(a=i.labels)&&a.length||0,o=i.options.isDataEnabled;r--;)t.push(n._getLabelObject(e,r,o,!r));else t.push(n._getLabelObject(e,b,!0,!0))}drawLabelConnectors(e,t,o){let r,a,n=e.config,i=this,l=i.getFromEnv("chart"),c=l.getFromEnv("animationManager"),h=l.config.scalingParams,d=o.getLinkedParent().getChildContainer("plot"),g=t&&t.length||0,p=n.showLabel;for(;g--;)r=e.graphics.connectorElem,p?e.graphics.connectorElem=r=c.setAnimation({el:e.graphics.connectorElem||"path",attr:{path:a=t[g],opacity:1,transform:s.tb||!m?"":h.transformStr,stroke:Object(s.P)(n.connectorColor,n.connectorAlpha),"shape-rendering":j,"stroke-width":n.connectorThickness},container:d,component:i,label:"labelConnectors"}):r&&r.hide()}entityClick(e,t){let o=e.node.__entity,r=this.getFromEnv("chart"),a=r.config.scalingParams,n=e.getBBox(),i=r.getFromEnv("linkClickFN"),l=o.config,s=l.link;n.width*=a.scaleFactor,n.height*=a.scaleFactor,n.x=n.x*a.scaleFactor+a.translateX,n.y=n.y*a.scaleFactor+a.translateY,n.x2=n.x+n.width,n.y2=n.y+n.height,r.fireChartInstanceEvent("entityclick",l.eventArgs,t),s!==b&&i.call({link:s,entity:o,entityBox:n},!0)}entityRollOver(e,t){let o=e.node.__entity,r=o.config,a=this.getFromEnv("chart"),n=a.getFromEnv("animationManager"),i=r.hoverAttr;a.plotEventHandler(e,t,"entityRollOver"),e.data("hovered")?clearTimeout(o.config.timer):r.useHoverColor&&r.isVisible&&!o.hidden&&i&&(a.config.hoverEntity=e,n.setAnimation({el:e,attr:i,component:this,state:"updating",label:"path"}),e.data("hovered",!0))}entityRollOut(e,t){let o,r=e.node.__entity,a=this,n=a.getFromEnv("chart"),i=n.getFromEnv("animationManager"),l=r.config.revertAttr;n.plotEventHandler(e,t,"entityRollOut"),r.config.timer=setTimeout(function(){!0!==(o=r.hidden)&&l&&(i.setAnimation({el:e,attr:l,component:a,state:"updating",label:"path"}),e.data("hovered",!1))},100)}addMouseGestures(e){let t,o,r,a,n,i=e.config,l=i.originalId,c=this,h=e.graphics,d=i.useHoverColor,g=i.hoverBorderThickness,p=i.hoverBorderColor,u=i.hoverBorderAlpha,f=i.entityBorderThickness,m=i.borderColor,v=i.borderAlpha,y=i.link,C=i.visibleEntityAttr,x=function(t){y!==b&&t.css({cursor:"pointer",_cursor:"hand"}),t.data("eventArgs",i.eventArgs),t.data("groupId","groupId"+l),t.node.__entity=e,e._listenersBinded||t.on("fc-click",c.entityClick.bind(c,t)).hover(c.entityRollOver.bind(c,t),c.entityRollOut.bind(c,t))};for(t in i.eventArgs={value:i.cleanValue,label:i.label,shortLabel:i.shortLabel,originalId:i.origId,id:i.id||i.origId},i.legacyEventArgs={value:i.value,lName:i.label,sName:i.shortLabel,id:i.originalId||i.id},d&&(i.hoverAttr={fill:Object(s.Vb)(i.hoverColor)},i.revertAttr={fill:Object(s.Vb)(i.fillColor),stroke:Object(s.Vb)(i.borderColor,i.borderAlpha)},i.revertAttr["fill-opacity"]=C["fill-opacity"],g!==f&&(i.hoverAttr["stroke-width"]=Object(s.Kb)(g,f),i.revertAttr["stroke-width"]=f),(p!==m||u!==v)&&(i.hoverAttr.stroke=Object(s.P)(p,u),i.revertAttr.stroke=Object(s.P)(m,v))),h)if(h.hasOwnProperty(t))if(h[t]instanceof Array){for(o=0,a=(n=h[t]).length;o<a;o++)x(r=n[o].outline);e._listenersBinded=!0}else x(r=h[t]),e._listenersBinded=!0}getDataLimits(){let e=this.config;return{max:e.max,min:e.min}}createContainer(){let e=this,t=e.getLinkedParent(),o=e.getFromEnv("animationManager"),r=t.getChildContainer("layer0");e.getChildContainer("abovePlotGroup")||e.addChildContainer("abovePlotGroup",o.setAnimation({el:"group",attr:{name:"abovePlotGroup",opacity:1},container:r,component:e,label:"group"})),e.getChildContainer("belowPlotGroup")||e.addChildContainer("belowPlotGroup",o.setAnimation({el:"group",attr:{name:"belowPlotGroup",opacity:1},container:r,component:e,label:"group"}))}initComplete(){let e=this.getFromEnv("chart");this.drawLabels(this.components.data),e.config.entitiesReady=!0,e.checkComplete()}}var q,Z=J,$=function(e,t,o,r,a){var n=Math.pow;return n(o-e,2)+n(r-t,2)<=n(a,2)},Q=Math.PI,ee=Math.cos,te=Math.sin,oe=Math.max,re=Math.min,ae=Q/180,ne=function(e,t,o,r,a,n){var i,l,s;return i=(r-t)*(a-o),l=(o-e)*(n-r),isNaN(i)&&(i=0),isNaN(l)&&(l=0),0==(s=i-l)?0:0<s?1:2},ie=function(e,t,o,r,a,n){return!!(o<=oe(e,a)&&o>=re(e,a)&&r<=oe(t,n)&&r>=re(t,n))},le=function(e,t,o,r,a,n,i,l){var s=ne(e,t,o,r,a,n),c=ne(e,t,o,r,i,l),h=ne(a,n,i,l,e,t),d=ne(a,n,i,l,o,r);return!!(s!==c&&h!==d||0===s&&ie(e,t,a,n,o,r)||0===c&&ie(e,t,i,l,o,r)||0===h&&ie(a,n,e,t,i,l)||0===d&&ie(a,n,o,r,i,l))},se=function(e,t,o,r,a,n,i){var l,s,c,h,d,g,p,b=0,u=!1;if($(e,t,o,r,a)&&3<=n){for(p=2*Q/n,c=o+a*ee(-(s=i===q?.5*Q:i%360*ae)),g=r+a*te(-s),l=0;l<n;l++){if(h=o+a*ee(-(s+=p)),d=r+a*te(-s),le(c,g,h,d,e,t,1/0,t)){if(0===ne(c,g,e,t,h,d))return ie(c,g,e,t,h,d);b++}c=h,g=d}u=0!=b%2}return u},ce=(e,t)=>!e||e&&t&&t.i>e.i?t:e;class he{constructor(e){this.configure(e)}configure(e){var t=this;t.validatorFn=e?t.shapeValidator():t.defaultValidator()}defaultValidator(){var e=Math.pow,t=this;return function(o){var r=t.mousePoint;return!!(o&&1>=e((o.x-r.x)/t.xLimit,2)+e((o.y-r.y)/t.yLimit,2))}}shapeValidator(){var e=this;return function(t){var o,r,a,n,i=e.mousePoint,l=t&&t.shapeInfo,s=!1,c=i.x,h=i.y;return"circle"===(o=l&&l.type)?s=$(c,h,t.x,t.y,r=l.radius):"arc"===o?(r=l.radius,s=!$(c,h,t.x,t.y,l.innerradius)&&$(c,h,t.x,t.y,r)):"polygon"===o?s=se(c,h,t.x,t.y,r=l.radius,l.sides,l.startAngle):"rect"===o||"rectangle"===o?(n=t.y,s=c>=(a=t.x)&&c<=a+(l.width||0)&&h>=n&&h<=n+(l.height||0)):"default"===o&&(s=!1),s}}buildKdTree(e){return this.kdTree=function(e){function t(e,t,o){var r=e[t];e[t]=e[o],e[o]=r}var o,r,a,n=e&&e[0]&&e[0].r||5,i=Math.max,l=Math.floor,s=Math.sqrt,c=Math.min,h=Math.log,d=Math.exp,g=Math.pow;for(r=function(e,o,a,n){for(var g,p,b,u,f,m,v,y,C,x;n>a;){for(600<n-a&&(p=o-a+1,b=h(g=n-a+1),u=.5*d(2*b/3),f=.5*s(b*u*(g-u)/g)*(0>p-g/2?-1:1),m=i(a,l(o-p*u/g+f)),v=c(n,l(o+(g-p)*u/g+f)),r(e,o,m,v)),y=e[o],C=a,x=n,t(e,a,o),e[n].x>y.x&&t(e,a,n);C<x;){for(t(e,C,x),C++,x--;e[C].x<y.x;)C++;for(;e[x].x>y.x;)x--}e[a].x===y.x?t(e,a,x):t(e,++x,n),x<=o&&(a=x+1),o<=x&&(n=x-1)}},a=function(e,o,r,n){for(var g,p,b,u,f,m,v,y,C,x;n>r;){for(600<n-r&&(p=o-r+1,b=h(g=n-r+1),u=.5*d(2*b/3),f=.5*s(b*u*(g-u)/g)*(0>p-g/2?-1:1),m=i(r,l(o-p*u/g+f)),v=c(n,l(o+(g-p)*u/g+f)),a(e,o,m,v)),y=e[o],C=r,x=n,t(e,r,o),e[n].y>y.y&&t(e,r,n);C<x;){for(t(e,C,x),C++,x--;e[C].y<y.y;)C++;for(;e[x].y>y.y;)x--}e[r].y===y.y?t(e,r,x):t(e,++x,n),x<=o&&(r=x+1),o<=x&&(n=x-1)}},o=(e=e||[]).length;o--;)e[o].r>n&&(n=e[o].r),e[o].i=o,e[o].x=+e[o].x,e[o].y=+e[o].y;return{tree:0===e.length?{}:function e(t,o,n,i){var l,s={},c=i?"y":"x";return o===n?(s.point=t[o],s):1==n-o?(t[o][c]>t[n][c]?(s.point=t[o],s.left={point:t[n]}):(s.point=t[n],s.left={point:t[o]}),s):(l=o+n>>1,i?a(t,l,o,n):r(t,l,o,n),s.point=t[l],s.left=e(t,o,l-1,!i),s.right=e(t,l+1,n,!i),s)}(e,0,e.length-1,!1),search:function(e,t,o,r){function a(e,t,o,r){return s(g(e-o,2)+g(t-r,2))}function i(r,n){return"circle"===o?a(r,n,e,t)<=u:r>=u&&r<=f&&n>=m&&n<=v}function l(e,t,o){return e>=t&&e<=o}function c(o){var r=l(e,o.x1,o.x2)&&l(t,o.y1,o.y2),n=a(e,t,o.point.x,o.point.y);return d?void(r?y?o.point.i>d.point.i&&(d=o,y=r,C=n):(d=o,y=r,C=n):!y&&n<C&&(d=o,y=r,C=n)):(d=o,y=r,void(C=n))}function h(r,a){"circle"===o?u=r:(u=e-r||0,f=e+r||0,m=t-a||0,v=t+a||0)}var d,p,b,u=e-n,f=e+n,m=t-n,v=t+n,y=!1,C=0;return r=r||{},b=function(e){e&&e.point&&(h(r.rx||e.point.r,r.ry||e.point.r),i(e.point.x,e.point.y)&&c(e),m<=e.point.y&&p(e.left),v>=e.point.y&&p(e.right))},(p=function(e){e&&e.point&&(h(r.rx||e.point.r,r.ry||e.point.r),i(e.point.x,e.point.y)&&c(e),u<=e.point.x&&b(e.left),f>=e.point.x&&b(e.right))})(this.tree),d&&d.point||d}}}(e),this.tree=this.kdTree.tree,this}getNeighbour(e,t,o){var r=this,a=r.tree,n={x1:e.x-r.xLimit,x2:e.x+r.xLimit,y1:e.y-r.yLimit,y2:e.y+r.yLimit},i=r.validatorFn;return r.mousePoint=e,t?this.kdTree&&this.kdTree.search(e.x,e.y,o,e.options):a?r._searchBtwnLimit(n,a,!0,i):void 0}_searchBtwnLimit(e,t,o,r){var a,n,i=o?e.x1:e.y1,l=o?e.x2:e.y2;if((a=t&&t.point&&t.point[o?"x":"y"])!==q)return r(t.point)&&(n=t.point),a>=i&&t.left&&(n=ce(n,this._searchBtwnLimit(e,t.left,!o,r))),a<=l&&t.right&&(n=ce(n,this._searchBtwnLimit(e,t.right,!o,r))),n}_setSearchLimit(e,t){this.xLimit=e,this.yLimit=t}}he.prototype.constructor=he;var de=he;let ge,pe="",be="top",ue="bottom",fe="right",me="left",ve="middle",ye="center",Ce=.6,xe=window.Math,Oe=xe.min,ke=xe.max,we="items",Fe=function(){let e,t=this,o=t.dataset.getFromEnv("chart"),r=t.dataset.getChildren("mapAnnotations")[0],a=t.markerShape,n=a.groupConfig,i=a.data("unfilteredConfig"),c=i._markerEventArgs,h=t.config;i.hovereffect&&("circle"===a.config.type&&(e=Object(s.W)({fillcolor:i.hoverfillcolor,fillalpha:i.hoverfillalpha,fillangle:i.hoverfillangle,fillratio:i.hoverfillratio,gradientUnits:"objectBoundingBox",radialGradient:1},i._hoverattrs)),e=Object(s.W)({},i._hoverattrs),r.update(a.getId(),e)),c||(c=i._markerEventArgs={x:+i.x,y:+i.y,scaledX:i.x*n.scaleX,scaledY:i.y*n.scaleY,chartX:i.x*n.scaleX+n.grpXShift,chartY:i.y*n.scaleY+n.grpYShift,id:i.id,label:i.label}),Object(l.e)(h.options.id,"markerRollOver",c,o.getFromEnv("chartInstance"),h,ge,ge,ge)},je=function(){let e,t=this,o=t.dataset.getFromEnv("chart"),r=t.dataset.getChildren("mapAnnotations")[0],a=t.markerShape,n=a.getElement(),i=t.config,c=a.data("unfilteredConfig");n&&c.hovereffect&&("circle"===a.config.type&&(e=Object(s.W)({fillcolor:a.config.rawColor,fillalpha:a.config.rawAlpha,fillangle:a.config.rawAngle,fillratio:a.config.rawRatio,gradientUnits:"objectBoundingBox",radialGradient:"radial"===a.config.rawFillPattern},c._defaultattrs)),e=Object(s.W)({},c._defaultattrs),r.update(a.getId(),e)),Object(l.e)(i.id,"markerRollOut",c._markerEventArgs,o.getFromEnv("chartInstance"),ge,ge,ge)},Ae=function(e){let t=this,o=t.config.options,r=t.dataset,a=r.getFromEnv("chart"),n=t.markerShape,i=n.config,l=n.groupConfig,s=r.getFromEnv("linkClickFN"),c=n.config.link,h=i._markerEventArgs;c&&s&&s.call({link:c},!0),h||(h=i._markerEventArgs={x:+i.x,y:+i.y,scaledX:i.x*l.scaleX,scaledY:i.y*l.scaleY,chartX:i.x*l.scaleX+l.grpXShift,chartY:i.y*l.scaleY+l.grpYShift,id:o.id,label:o.label}),a.fireChartInstanceEvent("markerClick",h,e)},Ie=function(e,t){let o,r=e&&e.length||!1,a=t||"id",n={};if(!e)return e;for(;r--;)(o=e[r])[a]!==ge&&(n[o[a].toLowerCase()]=o);return n};Object(h.a)({name:"mapsAnimation",type:"animationRule",extension:g});class Le extends Z{constructor(){super(),this.components={},this.getLabelAlignment={top:function(e,t,o){return{x:e.toString(),y:(t-o).toString(),align:ye,valign:be}},left:function(e,t,o){return{x:(e-o).toString(),y:t.toString(),align:fe,valign:ve}},right:function(e,t,o){return{x:(e+o).toString(),y:t.toString(),align:me,valign:ve}},bottom:function(e,t,o){return{x:e.toString(),y:(t+o).toString(),align:ye,valign:ue}},center:function(e,t){return{x:e.toString(),y:t.toString(),align:ye,valign:ve}}},this.getWrapWidth={right:function(){return arguments[1]},left:function(e,t){return e-t},center:function(e,t){return 2*Oe(t,e-t)}},this.getWrapHeight={top:function(){return arguments[1]},middle:function(e,t){return 2*Oe(t,e-t)},bottom:function(e,t){return e-t}},this.hoverFn=Fe,this.hoverOutFn=je,this.clickFn=Ae}getName(){return"markers"}getType(){return"dataset"}configureAttributes(e){if(!e)return;this.JSONData=e;let t,o=this,r=o.getChildren("mapAnnotations")&&o.getChildren("mapAnnotations")[0],a=o.getFromEnv("chart").config.markerOpts;r||(t=new c.a,o.attachChild(t,"mapAnnotations"),r=o.getChildren("mapAnnotations")[0]),r.destroy(),o.calculateDataLimits(),a.dataEnabled?this._parseMarkers():this.defineMarkersNShapes(),this.configureConnectors()}calculateMarkerRadiusLimits(){if(this.JSONData){let e=this,t=e.JSONData,o=e.config,r=e.getFromEnv("chart"),a=Le.getMarkerRadiusLimits(r.config.width,r.config.height,t.markermaxradius,t.markerminradius);o.minRadius=a.min,o.maxRadius=a.max}}calculateDataLimits(){let e,t,o,r,a,n=this.getFromEnv("chart"),i=this.config,l=(n.jsonData.markers||{})[we]||[],s=this.getFromEnv("number-formatter"),c=1/0,h=-1/0;for(a=0,o=l.length;a<o;a++)null!==(t=s.getCleanValue(r=(e=l[a]).value))&&(c=Oe(t,c),h=ke(t,h));i.min=c,i.max=h}_parseMarkers(){let e,t,o,r,a,n,i,l,c=this,h=c.getFromEnv("chart"),d=h.jsonData.markers,g=d[we],p=d.shapes,b=h.config.markerOpts,u=this.getFromEnv("number-formatter"),f=c.components.shapeObjs={},m=c.components.markerObjs={};if(g&&g.length){if(p&&p.length)for(t=p.length;t;t-=1)(l=(r=p[t-1]).id.toLowerCase())&&(f[l]=r);for(t=g.length;t--;)(l=(r=g[t]).id&&r.id.toLowerCase())&&((e=r.value)!==ge&&""!==e&&(e=parseFloat(e)),(a=(o=Le._initializeMarkerItem(l,r,null,h)).config.options.shapeid)&&"string"==typeof a&&(a=a.toLowerCase()),i=(n=o.config).options,n.cleanValue=u.getCleanValue(e),n.formattedValue=null===n.cleanValue?ge:u.dataLabels(e),n.fillColor=Object(s.Ib)(i.fillcolor,i.color,b.fillColor),n.fillAlpha=Object(s.Ib)(i.fillalpha,i.alpha,b.fillAlpha),n.fillRatio=Object(s.Ib)(i.fillratio,b.fillRatio),n.fillAngle=Object(s.Ib)(i.fillangle,b.fillAngle),n.borderThickness=Object(s.Kb)(i.borderthickness,b.borderThickness),n.borderColor=Object(s.Ib)(i.bordercolor,b.borderColor),n.borderAlpha=Object(s.Ib)(i.borderalpha,b.borderAlpha),n.labelPadding=i.labelpadding||b.labelPadding,o.dataset=c,r.__hideMarker&&(o._isHidden=!0),a&&(o.shapeObj=f[a]),m[l]=o)}}defineMarkersNShapes(){let e,t,o,r,a,n,i,l,c=this,h=c.getFromEnv("chart"),d=h.jsonData.markers,g=d.definition,p=this.getFromEnv("number-formatter"),b=h.config.markerOpts,u=Ie(g)||{},f=Ie(d.application)||{},m=d.shapes,v=c.components.shapeObjs=c.components.shapeObjs||(c.components.shapeObjs={}),y=c.components.markerObjs=c.components.markerObjs||(c.components.markerObjs={}),C={},x={};if(g&&g.length){for(r in v)C[r]=!1;for(r in y)x[r]=!1;if(m&&m.length)for(r=m.length;r;r-=1)(l=(n=m[r-1]).id.toLowerCase())&&(v[l]=n,C[l]=!0);for(l in u)a=y[l]=Le._initializeMarkerItem(l,n=u[l],f[l],h),x[l]=!0,a.dataset=c,i=a.config.options.shapeid,(t=a.config).cleanValue=p.getCleanValue(o=n.value),e=t.options,t.formattedValue=null===t.cleanValue?ge:p.dataLabels(o),t.fillColor=Object(s.Ib)(e.fillcolor,e.color,b.fillColor),t.fillAlpha=Object(s.Ib)(e.fillalpha,e.alpha,b.fillAlpha),t.fillRatio=Object(s.Ib)(e.fillratio,b.fillRatio),t.fillAngle=Object(s.Ib)(e.fillangle,b.fillAngle),t.borderThickness=Object(s.Kb)(e.borderthickness,b.borderThickness),t.borderColor=Object(s.Ib)(e.bordercolor,b.borderColor),t.borderAlpha=Object(s.Ib)(e.borderalpha,b.borderAlpha),t.labelPadding=e.labelpadding||b.labelPadding,t.options.tooltext=Object(s.Ib)(e.tooltext,b.tooltext),t.link=e.link,i&&(a.shapeObj=v[i.toLowerCase()]);for(r in C)C[r]||delete v[r];for(r in y)x[r]||delete y[r]}}static getMarkerRadiusLimits(e,t,o,r){let a=Oe(e,t);return r=parseFloat(r),o=parseFloat(o),isNaN(r)||isNaN(o)?isNaN(r)?isNaN(o)?{min:.02*a,max:.07*a}:{min:parseInt(o/10,10),max:o}:{min:r,max:10*r}:r<o?{min:r,max:o}:{min:o,max:r}}getDataLimits(){let e=this.config;return{min:e.min,max:e.max}}static _initializeMarkerItem(e,t,o){let r,a={},n=a.config;return n||(n=a.config={}),n.id=e,n.definition=t,n.application=o,n.hasValue=null,n.value=null,n.options=null,n.label=null,n.markerShape=null,n.markerLabel=null,n.drawOptions={shape:null,label:null},n.drawComplete=!1,r=a.config.options=Object(s.W)({},n.definition),n.dataEnabled?!isNaN(r.value)&&""!==r.value&&(a.value=parseFloat(r.value),a.hasValue=!0):n.applyAll?n.options=Object(s.W)(r,n.application):o&&(n.options=Object(s.W)(r,n.application)),a}configureConnectors(){let e,t,o,r,a,n,i,l,c,h,d,g,p,b,u=this,f=u.getFromEnv("chart"),m=u.getChildren("mapAnnotations")[0],v=f.jsonData.markers||{},y=v.connector||v.connectors||[],C=u.components.markerObjs,x=y.length,O=u.components.connectors,k=function(e){return function(t){let o=this.data("unfilteredConfig");o.hoverEffect&&m.update(this.getId(),o._hoverAttrs),f.fireChartInstanceEvent("connectorrollover",e,t)}},w=function(e){return function(t){let o=this.data("unfilteredConfig");o.hoverEffect&&m.update(this.getId(),o._defaultAttrs),f.fireChartInstanceEvent("connectorrollout",e,t)}},F=function(e){return function(t){f.fireChartInstanceEvent("connectorClick",e,t)}},j=f.config.connectorOpts,A={};for(O=u.components.connectors=[],b=0;b<x;b++)((p=y[b]).from||p.to)&&(t=C[p.from.toLowerCase()],o=C[p.to.toLowerCase()],t&&o)&&(r=y[b].label,(A=O[b])||(A=O[b]={}),A.config||(e=A.config={}),A.graphics||(A.graphics={}),(e=A.config=Object(s.W)({},p)).fromMarker=t,e.toMarker=o,e.link=p.link,e.showTooltip=Object(s.Kb)(p.showtooltip,j.showTooltip),a=e.tooltext=e.showTooltip?Object(s.Ib)(p.tooltext,j.tooltext):pe,n=e.thickness=Object(s.Ib)(p.thickness,j.thickness),i=e.color=Object(s.Ib)(p.color,j.color),l=e.alpha=Object(s.Ib)(p.alpha,j.alpha),e.hoverEffect=Object(s.Kb)(p.showhovereffect,j.showHoverEffect),c=Object(s.Ib)(p.hovercolor,j.hoverColor,i),h=Object(s.Ib)(p.hoveralpha,j.hoverAlpha,l),d=Object(s.Ib)(p.hoverthickness,j.hoverThickness,n),e.dashed=Object(s.Ib)(p.dashed,j.dashed),e.dashLen=Object(s.Kb)(p.dashlen,j.dashlen),e.dashGap=Object(s.Kb)(p.dashgap,j.dashgap),a&&(e.tooltext=a=Object(s.Hb)(Object(s.Gb)(a,[3,40,41,42,43],{label:r,fromId:t.config.definition.id,toId:o.config.definition.id,fromLabel:t.config.definition.label,toLabel:o.config.definition.label},void 0))),e.eventArgs={fromMarkerId:t.config.id,toMarkerId:o.config.id,label:r},e._hoverAttrs={color:c,alpha:h,thickness:d},e._defaultAttrs={color:i,alpha:l,thickness:n},e.type="line",e.onclick=F(e.eventArgs),e.onmouseover=k(e.eventArgs),e.onmouseout=w(e.eventArgs),r&&(!(g=A.labelConfig)&&(g=A.labelConfig={}),g.type="text",g.text=r,g.align=ye,g.valign=ve,g.font=j.font,g.fillcolor=j.fontColor,g.bgcolor=j.labelBgColor,g.bordercolor=j.labelBorderColor,g.tooltext=e.tooltext))}draw(){let e,t,o,r,a,n,i,l=this,s=l.getFromEnv("chart"),c=l.config,h=l.getChildren("mapAnnotations")[0],d=l.components.markerObjs,g=s.config,b=g.markerOpts,u=g.scalingParams,f=s.config.annotationConfig,m=[],v=[],y={};for(a in l.createContainer(),l._drawConnectors(),l.imageLoadCount=0,l.imageCount=0,i=h.addGroup(Object.assign(f,{id:"markers",fillalpha:"100",items:m,scaleimages:1}),l),n=h.addGroup(Object.assign(f,{id:"markerLabels",items:v,scaleimages:1}),l),l.components.markerGroup=i,l.components.markerLabelGroup=n,c.autoScale=b.autoScale?u.sFactor:1,d)e=null,(r=(t=d[a]).config).conIsHidden||(e=this._drawMarkerItem.call(t)),e&&(r._annotationIndex=m.length,y[a]=t,e.markerShape&&(o=Object.assign({align:"center",valign:"middle",animationLabel:"markerItem",autoscale:"image"===e.markerShape.type?0:1},e.markerShape),t.markerShape=h.addItem(i.getId(),o,l)),t.markerShape.data("unfilteredConfig",o),m.push(t.markerShape),e.markerLabel&&(o=Object.assign({animationLabel:"markerItem"},e.markerLabel),t.markerLabel=h.addItem(n.getId(),o,l),t.markerLabel.data("unfilteredConfig",o)),v.push(t.markerLabel));l.addJob("buildKdtree",l._buildKdTree.bind(l),p.b.kdTree)}_buildKdTree(){let e,t,o=this,r=o.components.kdArrayMap,a=o.components.markerGroup,n=[],i=a&&a.items,l=i&&i.length||0;for(t=0;t<l;t++)r[e=i[t].config.id]&&n.push(r[e]);o.components.kDTree||(o.components.kDTree=new de(!0)),o.components.kDTree._setSearchLimit(1/0,1/0),o.components.kDTree.buildKdTree(n)}_drawMarkerItem(){let e,t,o,r,a,n,i,l,c,h,d,g,p,b,u,f,m,v,y=this,C=y.dataset,x=C.getFromEnv("chart"),O=x.config,k=C.config,w=O.scalingParams,F=y.config,j=F.options,A=F.definition,I=O.markerOpts,L=I.dataLabels.style,S=j.shapeid,E=j.scale||1,_=j.label||pe,P=x.config.scalingParams.scaleFactor*x.config.baseScaleFactor,T=(j.labelpos||be).toLowerCase(),R=F.formattedValue===ge?ge:F.formattedValue,M=j.tooltext||I.tooltext,B=Object(s.Kb)(A.radius,F.radius,I.radius)*E*k.autoScale||1e-4,K=F.fillColor,D=F.fillAlpha,V=F.fillRatio,G=F.fillAngle,N=F.borderThickness,W=F.borderColor,H=F.borderAlpha,z=C.getChildren("mapAnnotations")[0],X=C.components.kdArrayMap||(C.components.kdArrayMap={}),Y=y.config.id;if(F.autoScale=I.autoScale?P:1,S)return M=M?Object(s.Hb)(Object(s.Gb)(M,[1,2,3],{formattedValue:R,label:_},j)):R?_+I.tooltipSepChar+R:_,R!==ge&&null!==R?_=_+I.labelSepChar+R:isNaN(E)?E=1:0>E?E=0:5<E&&(E=5),Object(s.W)(j,{x:j.x&&j.x.toString(),y:j.y&&j.y.toString(),fillcolor:K,fillalpha:D,fillratio:V,fillangle:G,borderthickness:N,bordercolor:W,borderalpha:H,hovereffect:Object(s.Ib)(I.showHoverEffect),radius:B&&B.toString(),link:j.link,showshadow:Object(s.Kb)(j.showshadow,F.shadow),_markerLabel:_,_markerId:j.id,id:(j.id+pe).toLowerCase()}),delete j.tooltext,F.tooltext=!!I.showTooltip&&M,p=+j.x*w.sFactor+w.translateX,b=+j.y*w.sFactor+w.translateY,B=j.radius,"triangle"===S?(Object(s.W)(j,{type:"polygon",sides:3,startangle:I.startAngle}),v="polygon",m=3):"diamond"===S?(Object(s.W)(j,{type:"polygon",sides:4,startangle:I.startAngle}),v="polygon",m=4):"arc"===S?(f=B*Ce,Object(s.W)(j,{type:"arc",startangle:0,endangle:360,innerradius:f}),v="arc"):"circle"===S?(j.type="circle",v="circle"):(d=C.getShapeArgs.call(y),I.dataEnabled&&I.valueToRadius&&j.radius!==ge?delete d.radius:(!d.radius&&(d.radius=I.radius),d.radius*=E*F.autoScale),Object(s.W)(j,d),j.id=j._markerId&&j._markerId.toLowerCase(),f=d.innerradius,d.radius&&(B=d.radius),v=d.type&&d.type.toLowerCase(),m=d.sides,(B=+B)&&f&&B<f&&(g=B,j.radius=B=f,j.innerradius=f=g)),j.type=j.type&&j.type.toLowerCase(),Object(s.W)(j,{hoverfillcolor:Object(s.Ib)(j.fillhovercolor,I.hoverFillColor,j.fillcolor),hoverfillalpha:Object(s.Ib)(j.fillhoveralpha,I.hoverFillAlpha,j.fillalpha),hoverfillratio:Object(s.Ib)(j.fillhoverratio,I.hoverFillRatio,j.fillratio),hoverfillangle:Object(s.Ib)(j.fillhoverangle,I.hoverFillAngle,j.fillangle),hoverborderthickness:Object(s.Kb)(j.borderhoverthickness,I.hoverBorderThickness,j.borderthickness),hoverbordercolor:Object(s.Ib)(j.borderhovercolor,I.hoverBorderColor,j.bordercolor),hoverborderalpha:Object(s.Ib)(j.borderhoveralpha,I.hoverBorderAlpha,j.borderalpha)}),j._hoverattrs={fillalpha:j.hoverfillalpha,fillcolor:j.hoverfillcolor,fillangle:j.hoverfillangle,fillratio:j.hoverfillratio,borderThickness:"0"===j.showborder?0:j.hoverborderthickness,borderColor:j.hoverbordercolor,borderAlpha:j.hoverborderalpha},j._defaultattrs={fillalpha:j.fillalpha,fillcolor:j.fillcolor,fillangle:j.fillangle,fillratio:j.fillratio,borderThickness:"0"===j.showborder?0:j.borderthickness,borderColor:j.bordercolor,borderAlpha:j.borderalpha},"image"===j.type?(j.borderthickness=j.borderthickness||0,j.onload=function(e){let t=e.width,o=e.height;u={},p=(+(j=this.config).derivedX-t/(2*w.sFactor))*w.sFactor,b=(+j.derivedY-o/(2*w.sFactor))*w.sFactor,(u=X[Y]||(X[Y]={})).x=p+w.translateX,u.y=b+w.translateY,u.element=y,u.shapeInfo={type:"rect",width:t,height:o},t&&o&&z.update(this.getId(),{x:p,y:b,width:t,height:o,autoscale:0}),C.imageLoadCount++,C.imageLoadCount===C.imageCount&&C._buildKdTree()},j.onerror=function(){C.imageLoadCount++,C.imageLoadCount===C.imageCount&&C._buildKdTree()},C.imageCount++):((u=X[Y]||(X[Y]={})).x=p,u.y=b,u.element=y,u.shapeInfo={type:v,sides:m,radius:+B+j.borderthickness/2,innerradius:f}),F.drawOptions.shape=j,I.showLabels?(t=(e=C._getLabelOptions(T,h=j.labelpadding||I.labelPadding,j)).align,o=e.valign,a=F._labelBaseHeight,i=F._labelYOffset,(l=I.labelWrapWidth?I.labelWrapWidth:C.getWrapWidth[t](r=F._labelBaseWidth,+e.x+(n=F._labelXOffset)))>h&&(l-=h),(c=I.labelWrapHeight?I.labelWrapHeight:C.getWrapHeight[o](a,+e.y+i))>h&&(c-=h),F.drawOptions.label=Object(s.W)({type:"text"},{text:_,tooltext:j.tooltext,x:e.x,y:e.y,align:t,valign:e.valign,wrap:1,wrapwidth:l,wrapheight:c,fontsize:L.fontSize/w.sFactor,font:L.fontFamily,fillcolor:L.fontColor}),{markerShape:j,markerLabel:F.drawOptions.label}):{markerShape:j}}highlightPoint(e,t){let o=e.element,r=this,a=t.originalEvent,n=r.getFromEnv("chart"),i=r.getFromEnv("toolTipController"),l=r.config.currentToolTip,s=n.config.lastHoveredPoint;s&&s!==e&&(s&&r.hoverOutFn.call(s.element),n.config.lastHoveredPoint=null,i.hide(l)),!1===e||("click"===t.type||"touchstart"===t.type?(n.config.lastHoveredPoint!==e&&r.hoverFn.call(o),r.clickFn.call(o,t)):"mousemove"===t.type&&n.config.lastHoveredPoint!==e&&r.hoverFn.call(o),o.config.tooltext&&(l?i.draw(a,o.config.tooltext,l):l=r.config.currentToolTip=i.draw(a,o.config.tooltext)),n.config.lastHoveredPoint=e)}_drawConnectors(){let e,t,o,r,a,n,i,l,s,c,h=this,d=h.getFromEnv("chart"),g=d.config.annotationConfig,p=h.components.connectors||(h.components.connectors=[]),b=p.length,u=d.config.scalingParams,f=d.config.connectorOpts,m=f.showLabels,v=h.getChildren("mapAnnotations")[0],y=[],C=[],x=[];for(x.push({id:"connectorLabels",fillalpha:"100",items:C}),x.push({id:"connectors",fillalpha:"100",items:y}),v.addGroup(Object.assign(g,x[1]),h),v.addGroup(Object.assign(g,x[0]),h),o=0;o<b;o++)p[o]&&(a=(l=p[o].config.fromMarker.config).options.y,n=(s=p[o].config.toMarker.config).options.x,i=s.options.y,p[o].config.x=r=l.options.x,p[o].config.y=a,p[o].config.tox=n,p[o].config.toy=i,y.push(p[o].config),c=Object.assign({animationLabel:"markerItem"},p[o].config),(e=v.addItem("connectors",c,h))&&e.data("unfilteredConfig",c),e.addEventListener("fc-mouseover",p[o].config.onmouseover),e.addEventListener("fc-mouseout",p[o].config.onmouseout),e.addEventListener("fc-click",p[o].config.onclick),p[o].labelConfig&&m&&(p[o].labelConfig.x=((+r+ +n)/2).toString(),p[o].labelConfig.y=((+a+ +i)/2).toString(),p[o].labelConfig.fontsize=f.fontSize/(u.scaleFactor*d.config.baseScaleFactor),C.push(p[o].labelConfig),c=Object.assign({animationLabel:"markerItem"},p[o].labelConfig),(t=v.addItem("connectorLabels",c,h))&&t.data("unfilteredConfig")))}getShapeArgs(){let e,t=this.config,o=Object(s.W)({},this.shapeObj);return t.autoScale=1,o?("polygon"===o.type?3>o.sides?o.type="circle":o.startangle=t.startAngle:"arc"===o.type&&(o.radius=e=(o.radius||t.markerRadius)*t.autoScale,o.innerradius=o.innerradius&&o.innerradius*t.autoScale||e*Ce),o):null}_getLabelOptions(e,t,o,r,a){let n,i,l,s=e&&e.toLowerCase();return this.getLabelAlignment[s]||(s="center"),i=+o.x,l=+o.y,n=r===ge||a===ge?o.radius||0:/^(top|bottom)$/gi.test(s)&&.5*a||/^(left|right)$/gi.test(s)&&.5*r||0,this.getLabelAlignment[s](i,l,n=+n+ +t)}addMarkerItem(e){let t,o,r,a,n,i,l,c=this,h=c.getFromEnv("chart"),d=e,g=c.components.markerObjs,p=c.components.shapeObjs,b=c.components.markerGroup,u=c.components.markerLabelGroup,f=c.getChildren("mapAnnotations")[0],m=c.getFromEnv("number-formatter"),v=h.config.markerOpts;if(l=d.id.toLowerCase()){if(g[l])return;delete d.value,c.imageLoadCount=0,(t=Le._initializeMarkerItem(l,d,null)).dataset=c,i=t.config.options.shapeid,(r=t.config).cleanValue=m.getCleanValue(n=d.value),e=r.options,r.formattedValue=null===r.cleanValue?ge:m.dataLabels(n),r.fillColor=Object(s.Ib)(e.fillcolor,e.color,v.fillColor),r.fillAlpha=Object(s.Ib)(e.fillalpha,e.alpha,v.fillAlpha),r.fillRatio=Object(s.Ib)(e.fillratio,v.fillRatio),r.fillAngle=Object(s.Ib)(e.fillangle,v.fillAngle),r.borderThickness=Object(s.Kb)(e.borderthickness,v.borderThickness),r.borderColor=Object(s.Ib)(e.bordercolor,v.borderColor),r.borderAlpha=Object(s.Ib)(e.borderalpha,v.borderAlpha),r.labelPadding=e.labelpadding||v.labelPadding,r.options.tooltext=Object(s.Ib)(e.tooltext,v.tooltext),r.link=e.link,i&&(t.shapeObj=p[i&&i.toLowerCase()]),g[l]=t,o=c._drawMarkerItem.call(t),b&&u&&(o.markerShape&&(a=Object.assign({align:"center",valign:"middle",animationLabel:"markerItem",autoscale:"image"===o.markerShape.type?0:1},o.markerShape),t.markerShape=f.addItem(b.getId(),a,c),t.markerShape.data("unfilteredConfig",a)),o.markerLabel&&(a=Object.assign({animationLabel:"markerItem"},o.markerLabel),t.markerLabel=f.addItem(u.getId(),a,c),t.markerLabel.data("unfilteredConfig",a))),c._buildKdTree()}}updateMarkerItem(e,t){let o,r,a,n,i=this,l=i.getFromEnv("chart"),c=i.getChildren("mapAnnotations")[0],h=l.config.markerOpts,d={},g=i.components.markerObjs[e];if(g){for(r in o=g.config.options,Object(s.W)(o,t),i.imageLoadCount=0,a=g.config,t)d[r.toLowerCase()]=t[r]&&t[r].toString();a.fillColor=Object(s.Ib)(d.fillcolor,d.color,h.fillColor),a.fillAlpha=Object(s.Ib)(d.fillalpha,d.alpha,h.fillAlpha),a.fillRatio=Object(s.Ib)(d.fillratio,h.fillRatio),a.fillAngle=Object(s.Ib)(d.fillangle,h.fillAngle),a.borderThickness=Object(s.Kb)(d.borderthickness,h.borderThickness),a.borderColor=Object(s.Ib)(d.bordercolor,h.borderColor),a.borderAlpha=Object(s.Ib)(d.borderalpha,h.borderAlpha),a.labelPadding=d.labelpadding||h.labelPadding,a.options.tooltext=Object(s.Ib)(d.tooltext,h.tooltext),a.link=d.link,n=i._drawMarkerItem.call(g).markerShape,i._buildKdTree(),c.update(e,n)}}createContainer(){let e=this,t=e.getLinkedParent(),o=e.getFromEnv("animationManager"),r=t.getChildContainer("layer1");e.getChildContainer("abovePlotGroup")||e.addChildContainer("abovePlotGroup",o.setAnimation({el:"group",attr:{name:"abovePlotGroup",opacity:1},container:r,component:e,label:"group"})),e.getChildContainer("belowPlotGroup")||e.addChildContainer("belowPlotGroup",o.setAnimation({el:"group",attr:{name:"belowPlotGroup",opacity:1},container:r,component:e,label:"group"}))}_removeMarkerItem(e){let t,o,r=this.components,a=r.markerObjs,n=a[e],i=r.kdArrayMap;n&&(o=n.markerLabel,(t=n.markerShape)&&t.dispose(),o&&o.dispose(),delete i[e],this._buildKdTree()),delete a[e]}getElement(e){if(this.components.kDTree)return this.components.kDTree.getNeighbour(e)}}var Se=Le;Object(h.a)({name:"mapsAnimation",type:"animationRule",extension:g});var Ee=class extends a.a{getType(){return"group"}getName(){return"mapGroup"}configure(){this._mapChildren(e=>{e.configure&&e.configure()})}createContainer(){let e,t=this,o=t.getLinkedParent(),r=t.getFromEnv("animationManager"),a=o.getChildContainer();e=a.plotGroup,t.getChildContainer("plotShadow")||t.addChildContainer("plotShadow",r.setAnimation({el:"group",attr:{name:"manager-plot-shadow",opacity:1},container:e,component:t,label:"group"})),t.getChildContainer("plot")||t.addChildContainer("plot",r.setAnimation({el:"group",attr:{name:"manager-plot",opacity:1},container:e,component:t,label:"group"})),t.getChildContainer("layer0")||t.addChildContainer("layer0",r.setAnimation({el:"group",attr:{name:"ann-layer0",opacity:1},container:a.abovePlotGroup,component:t,label:"group"})),t.getChildContainer("layer1")||t.addChildContainer("layer1",r.setAnimation({el:"group",attr:{name:"ann-layer1",opacity:1},container:a.abovePlotGroup,component:t,label:"group"})),o.config.labelsOnTop?t.getChildContainer("layer0").toFront():t.getChildContainer("layer0").toBack()}_transformGroup(){let e=this,t=this.getFromEnv("chart"),o=t.getFromEnv("chartInstance"),r=e.getFromEnv("animationManager"),a=e.getChildContainer("plot"),n=e.getChildContainer("plotShadow"),i=t.config.scalingParams;a.hide(),n.hide(),t.config.entitiesReady=!1,o.addEventListener("internal.mapdrawingcomplete",function(t){t.detachHandler(),s.tb&&(a&&r.setAnimation({el:a,attr:{transform:i.transformStr},component:e,label:"group"}),n&&r.setAnimation({el:n,attr:{transform:i.transformStr},component:e,label:"group"})),a.show(),n.show()}),t.checkComplete()}draw(){this.createContainer(),this._transformGroup()}getDataLimits(e){let t,o=1/0,r=-1/0,a=0,n=function(e){r=Math.max(r,e.max),o=Math.min(o,e.min)};return this._mapChildren(o=>o.getState("removed")||!1===o.getState("visible")?void(e&&(t=o.getDataLimits(e),n(t))):(a++,t=o.getDataLimits(e),void n(t))),this.setState("visible",!!a),this.config.range||(this.config.range={},this.config.range.min=this.config.dataMin,this.config.range.max=this.config.dataMax),{max:r,min:o}}},_e=function(e){var t,o=e.getFromEnv("dataSource"),r=o.data||{},a=o.markers;Object(s.O)(e,Ee,"mapGroup"),t=e.getChildren("mapGroup")[0],Object(s.T)(t,Z,"entities",1,[r]),a?Object(s.T)(t,Se,"markers",1,[a]):e.getDatasets()[1]&&e.getDatasets()[1].remove()},Pe=o("Hyvj");let Te=function(e,t,o){let r=e[0],a=e[1],n=e[2],i=r+(t[0]-r)*o,l=a+(t[1]-a)*o,c=n+(t[2]-n)*o;return{hex:(s.e+(i<<16|l<<8|c).toString(16)).slice(-6),rgb:[i,l,c]}};var Re=class extends a.a{constructor(){super();let e=this;e.mapByCategory=!1,e.colorArr=[],e.noValidRange=!0,e.sortLegend=!1}__setDefaultConfig(){super.__setDefaultConfig(),this.config.defaultObj={code:"CCCCCC",alpha:"100"}}getType(){return"colorComponent"}getName(){return"colorBucket"}configure(e){if(!e)return;let t,o,r,a,n,i,l,c,h,d,g,p=this,b=p.mapByCategory,u=e.numberFormatter,f=e.colorRange||{},m=Object(s.W)([],f.color),v=this.getLinkedParent(),y=p.getFromEnv("dataSource"),C=Math.min(Math.max(Object(s.Kb)(y.chart.palette,0)-1,0),4),x=v.defaultPaletteOptions&&v.defaultPaletteOptions.paletteColors[C],O=Object(s.Kb)(u.getCleanValue(f.maxvalue),1/0),k=Object(s.Kb)(u.getCleanValue(f.minvalue),-1/0),w=p.colorArr;if(void 0!==e.mapByCategory&&(b=p.mapByCategory=!!+e.mapByCategory),(m=m.filter(b?e=>e.code||e.color:e=>e.minvalue||e.maxvalue)).forEach(e=>{e.minvalue&&e.maxvalue&&+e.maxvalue<+e.minvalue&&(c=e.maxvalue,e.maxvalue=e.minvalue,e.minvalue=c),e.minvalue?e.maxvalue?(d=u.getCleanValue(e.minvalue),h=u.getCleanValue(e.maxvalue),e.rangeLabel=u.dataLabels(d)+"-"+u.dataLabels(h)):(d=u.getCleanValue(e.minvalue),e.maxvalue=h=O,e.rangeLabel=h===1/0?">"+u.dataLabels(d):u.dataLabels(d)+"-"+u.dataLabels(h)):(e.minvalue=d=k,h=u.getCleanValue(e.maxvalue),e.rangeLabel=d===-1/0?"<"+u.dataLabels(h):u.dataLabels(d)+"-"+u.dataLabels(h))}),m.sort((e,t)=>+e.minvalue==+t.minvalue?e.maxvalue-t.maxvalue:e.minvalue-t.minvalue),m&&(t=m.length)){for(w.length=0,o=0;o<t;o+=1)l=m[o],r=Object(s.Ib)(l.color,l.code,x&&x[o]),a=Object(s.Ib)(l.alpha),i=Object(s.Ib)(l.bordercolor),n=Object(s.Ib)(l.borderalpha,100),h=Object(s.Kb)(l.maxvalue),d=Object(s.Kb)(l.minvalue),g=Object(s.Ib)(l.label,l.displayvalue,l.rangeLabel),(r&&h>=d||b&&g)&&w.push({code:r,alpha:a||"100",oriAlpha:a,maxvalue:h,minvalue:d,label:Object(s.Hb)(g),labelId:g.toLowerCase(),bordercolor:i,borderAlpha:n,name:l.name});p.sortedColorArr=p.colorArr.slice(0)}else p.noValidRange=!0,p.colorArr=[],p.sortedColorArr=[]}getColorObj(e){if(void 0===e)return{outOfRange:!0};let t,o,r=this,a=r.sortedColorArr,n=r.gradient?1:0,i=a[n];if(r.mapByCategory){for(e=Object(s.Hb)(e).toLowerCase()||e.toString().toLowerCase();i;){if(i.labelId===e||i.maxvalue>=e&&i.minvalue<=e)return{code:i.code,alpha:i.alpha||"100",oriAlpha:i.oriAlpha,seriesIndex:n,legendItemId:i.legendItemId};i=a[n+=1]}return{outOfRange:!0}}if(r.gradient){if(r.scaleMin<=e&&r.scaleMax>=e){for(;i&&i.maxvalue<e;)i=a[n+=1];return{code:Te(a[n-1].codeRGB,i.codeRGB,o=(e-i.minvalue)/i.range).hex}}return{outOfRange:!0}}for(;i;){if(e<i.minvalue&&!t)return 0==n?{code:i.code,alpha:i.alpha||"100",oriAlpha:i.oriAlpha,seriesIndex:n,name:i.name,label:i.label,outOfRange:!0,bordercolor:i.bordercolor,borderalpha:i.borderAlpha}:{code:a[n-1].code,alpha:a[n-1].alpha||"100",oriAlpha:a[n-1].oriAlpha,seriesIndex:n,name:a[n-1].name,label:a[n-1].label,outOfRange:!0,bordercolor:a[n-1].bordercolor,borderalpha:a[n-1].borderAlpha};if(e>i.maxvalue&&n==a.length-1)return{code:i.code,alpha:i.alpha||"100",oriAlpha:i.oriAlpha,seriesIndex:n,name:i.name,label:i.label,outOfRange:!0,bordercolor:i.bordercolor,borderalpha:i.borderAlpha};if(i.maxvalue>e&&i.minvalue<=e)return{code:i.code,alpha:i.alpha||"100",oriAlpha:i.oriAlpha,seriesIndex:n,name:i.name,label:i.label,bordercolor:i.bordercolor,borderalpha:i.borderAlpha};if(e===i.maxvalue&&(t={code:i.code,alpha:i.alpha||"100",oriAlpha:i.oriAlpha,seriesIndex:n,name:i.name,label:i.label,bordercolor:i.bordercolor,borderalpha:i.borderAlpha}),n==a.length-1&&t)return t;i=a[n+=1]}return a.length?void 0:{outOfRange:!0}}getColorRangeArr(e,t){var o,r,a,n,i,l,c,h,d=this.colorArr,g=[];if(!this.defaultAsigned&&(e>t&&(o=e,e=t,t=o),e<t&&(n=this.getColorObj(e),l=this.getColorObj(t),n&&l))){for(i=e,r=n.seriesIndex,a=l.seriesIndex;r<=a;r+=1)(c=Object(s.W)({},d[r])).minvalue!==i&&(c.minvalue=i),g.push(c),h=c,i=c.maxvalue;h&&(h.maxvalue=t)}return g}};let Me=(e,t,o)=>{var r,a,n=Math.round,i=e.value,l=e.code,c=Object(s.m)(l),h=t.value,d=t.code,g=Object(s.m)(d);return a=[n(c[0]+(g[0]-c[0])/(r=h-i)*(o-i)),n(c[1]+(g[1]-c[1])/r*(o-i)),n(c[2]+(g[2]-c[2])/r*(o-i))],Object(s.A)(a)};var Be=class extends a.a{constructor(){super(),this.colorRange={},this.valueRatio={},this.data={},this.mapByPercent=void 0}getType(){return"colorComponent"}getName(){return"gradientColorRange"}configure(e){if(!e)return;let t,o,r,a=this;for(a.data=e,a.appender="",r=a.colorRange=e.colorRange.sort(function(e,t){return e.value-t.value}),a.valueRatio=void 0,a.values=[],t=0,o=r.length;t<o;t++)a.values.push(r[t].value)}getValueRatio(){var e,t,o=this.colorRange,r=o.length,a=this.valueRatio,n=o[r-1].value,i=o[0].value,l=0;if(a)return a;for(a=this.valueRatio=[],e=0;e<r;e++)a.push(100*((t=(o[e].value-i)/(n-i))-l)),l=t;return a}getCumulativeValueRatio(){var e,t=this.colorRange,o=t.length,r=t[0].value,a=t[o-1].value,n=[];for(e=0;e<o;e++)n.push((t[e].value-r)/(a-r)*100);return n}getBoxFill(e){var t,o,r,a=this.colorRange,n=a.length,i=[];for(r=e?90:0,t=0;t<n;t++)i.push(a[t].code);return o={FCcolor:{alpha:"100,100,100",angle:r,color:i.join(","),ratio:this.getValueRatio().join(",")}},Object(s.Vb)(o)}getColorByValue(e){var t,o,r,a,n=this.values,i=this.colorRange;if(null!=e){for(o=0,t=n.length;o<t;o++){if(e===n[o]){a=i[o].code;break}if(!o&&e<n[o]){r=!0;break}if(o===t-1&&e>n[o]){r=!0;break}if(e>n[o]&&e<n[o+1]){a=Me(i[o],i[o+1],e);break}}return r?void 0:a}}};function Ke(e){return Object(s.rb)(e||Ve)||Ve}let De="rgba(192,192,192,"+(s.zb?.002:1e-6)+")",Ve="#000000",Ge=function(){var e,t={legendCarpetConf:{spreadFactor:.85,allowDrag:!1,captionAlignment:"center",padding:{v:3,h:3},style:{fill:"#e4d9c1",stroke:"#c4b89d"}},legendCaptionConf:{spreadFactor:.2,padding:{v:2,h:2},style:{fill:"#786B50",fontFamily:"sans-serif",fontSize:"12px",fontWeight:"bold",fontStyle:"normal"},bound:{style:{stroke:"none"}}},legendBodyConf:{spreadFactor:.8,padding:{v:2,h:2},bound:{style:{stroke:"none"}}}};return t.legendAxisConf={legendAxisHeight:11,spreadFactor:.4,padding:{v:1,h:1},style:{stroke:"none","stroke-opacity":0,"stroke-width":1},line:{grooveLength:3,offset:8,style:{stroke:"rgba(255, 255, 255, 0.65)","stroke-width":1.5}},shadow:{style:{stroke:"none",fill:Object(s.Vb)({FCcolor:{alpha:"25,0,0",angle:360,color:"000000,FFFFFF,FFFFFF",ratio:"0,30,40"}})}},bound:{style:{stroke:"none"}}},t.sliderGroupConf={showTooltip:1,outerCircle:{rFactor:1.4,style:{fill:De,stroke:"#757575","stroke-width":3}},innerCircle:{rFactor:.65,style:{fill:De,stroke:"#FFFFFF"}}},t.axisTextItemConf={spreadFactor:.3,padding:{v:1,h:1},style:{fill:"#786B50",fontFamily:"sans-serif",fontSize:"12px",fontWeight:"normal",fontStyle:"normal"}},{init:function(t){e=t.chart},legacyDataParser:function(t,o){var r,a,n,i,l,c,h,d,g,p,b,u,f=Math.max,m=Math.min,v={},y=e.getFromEnv("number-formatter"),C=e.getFromEnv("dataSource"),x=C.dataset,O=C.data;if(o=o||{},!t)return!1;for("maps"!==e.defaultDatasetType||void 0!==o.min&&void 0!==o.max?"HeatMap"===e.getName()&&(void 0===o.min||void 0===o.max)&&(o={min:1/0,max:-1/0},x.forEach(e=>{e.data&&e.data.forEach(e=>{o.min=m(o.min,Object(s.Kb)(e.value,o.min)),o.max=f(o.max,Object(s.Kb)(e.value,o.max))})})):(o={min:1/0,max:-1/0},O&&O.forEach(e=>{o.min=m(o.min,Object(s.Kb)(e.value,o.min)),o.max=f(o.max,Object(s.Kb)(e.value,o.min))})),v.mapByPercent=b=!!Object(s.Kb)(t.mapbypercent,0),r=t.color||[],void 0===t.minvalue&&(t.minvalue=void 0===o.min?0:b?0:o.min),void 0===t.maxvalue&&(t.maxvalue=void 0===o.max?100:b?100:o.max),(t.maxvalue===t.minvalue||o.min===1/0||o.max===-1/0)&&(t.minvalue=0,t.maxvalue=100),u=!1,l=0,h=r.length;l<h;l++)if(r[l].maxvalue){u=!0;break}for(u||(r=[]),n=t.code,d=v.colorRange=[],v.gradient=!!Object(s.Kb)(t.gradient,1),r.length?n=Ke(n):(n?(i=Ke(n),n=Ke()):i=function(e){return Object(s.jb)(e,1)}(n=Ke()),r.push({code:i,maxvalue:t.maxvalue,label:void 0})),function(t){var o,r,a,n=e.getFromEnv("number-formatter");for(o=0,r=t.length;o<r;o++)(a=t[o].maxvalue)&&(t[o].maxvalue=n.getCleanValue(a))}(r),r=r.sort(function(e,t){return e.maxvalue-t.maxvalue}),g=p=t.minvalue&&y.getCleanValue(t.minvalue),p=(void 0!==g||null!==g)&&(b?g+"%":y.legendValue(g)),d.push({code:Object(s.U)(n),value:g,displayValue:p,label:t.startlabel}),l=0,h=r.length;l<h;l++)c=Ke((a=r[l]).code||a.color),g=p=a.maxvalue,!isNaN(parseInt(g,10))&&(p=(void 0!==g||null!==g)&&(b?g+"%":y.legendValue(g)),d.push({code:Object(s.U)(c),value:g,displayValue:p,label:a.label||a.displayvalue}));return d[d.length-1].label=t.endlabel||a.label,v},getDefaultConf:function(e){return t[e]}}}();var Ne=class extends a.a{constructor(){super(),this.datasource={},this.config.legendItemIds=[]}configure(){let e,t,o,r=this,a=this.getFromEnv("chart"),n="maps"===a.defaultDatasetType,i="TreeMap"===a.getName(),l=this.getFromEnv("dataSource").chart.mapbycategory,c=a.getFromEnv("number-formatter"),h=a.config.showLegend,d=a.getChildren("colorRange")&&a.getChildren("colorRange")[0];a.addToEnv("colorManager",r),r.datasource=a.getFromEnv("dataSource"),e=r.datasource.colorrange,d&&d.remove({instant:!0}),h||(r.config.legendItemIds=[]),"gradient"==(t=n?e.gradient&&+e.gradient?"gradient":e.color?"icon":"none":i?"gradient":e.gradient&&"0"!=e.gradient&&!+l?"gradient":"icon")?(Ge.init({chart:a}),o=Ge.legacyDataParser(e),Object(s.O)(a,Be,"colorRange",1,[o]),d=a.getChildren("colorRange")[0],a.addToEnv("colorRange",d),o||(d._dontPlot=!0),r.config.legendItemIds=[],r._configureGradientLegend(d)):"icon"===t?(Object(s.O)(a,Re,"colorRange",1,[{colorRange:e,sortLegend:0,mapByCategory:Object(s.Kb)(l,0),defaultColor:"cccccc",numberFormatter:c}]),a.addToEnv("colorRange",a.getChildren("colorRange")[0]),h&&r._addLegendItems()):"none"===t&&(a.deleteFromEnv("colorManager"),r.config.legendItemIds=[])}_configureGradientLegend(e){let t=this,o=t.getFromEnv("chart").getFromEnv("gLegend");o&&(o.setColorRange(e),t.addExtEventListener("rangeUpdated",function(e,o){t.fireEvent("legendUpdate",{"original-event":e,maxMinArray:o,component:"gradientlegend"})},o))}_addLegendItems(){let e,t,o,r,a,n=this,i=n.config,l=n.getFromEnv("chart"),c=l.getChildren("legend")[0],h=l.getFromEnv("colorRange").colorArr,d=h.length;for(r=0;r<d;r++)a={label:Object(s.Ib)(h[r].label,h[r].displayvalue),datasetObj:h[r],index:r},t=Object(s.jb)(h[r].code,40),e={FCcolor:{color:h[r].code+","+h[r].code+","+t,ratio:"0,70,30",angle:270,alpha:"100,100,100"}},(o=c.getItem(i.legendItemIds[r]))||(i.legendItemIds.push(c.createItem(n)),(o=c.getItem(i.legendItemIds[r])).addEventListener("fc-click",o.itemClickFn)),o.removeLegendState("hidden"),h[r].legendItemId=o&&o.getId(),o.configure(a),o.setStateCosmetics("default",{symbol:{fill:Object(s.Vb)(e),rawFillColor:h[r].code}});for(r=d;r<i.legendItemIds.length;r++)c.disposeItem(i.legendItemIds[r]);i.legendItemIds.splice(d)}legendInteractivity(e){let t=this.getFromEnv("colorRange").colorArr[e.config.index];this.fireEvent("legendUpdate",{legendItem:e,colorObj:t,component:"legend"})}getColor(e){let t=this;return!+t.datasource.chart.mapbycategory&&+t.datasource.colorrange.gradient?{code:t.getColorByValue(e)}:t.getColorObj(e)}getValueRatio(){return this.getFromEnv("colorRange").getValueRatio()}getCumulativeValueRatio(){return this.getFromEnv("colorRange").getCumulativeValueRatio()}getBoxFill(e){return this.getFromEnv("colorRange").getBoxFill(e)}getColorByValue(e){return this.getFromEnv("colorRange").getColorByValue(e)}getColorObj(e){return this.getFromEnv("colorRange").getColorObj(e)}},We=function(e){!function(e){let t=e.getChildren("colorManager");e.getFromEnv("dataSource").colorrange?t?(e.addToEnv("colorManager",t[0]),t[0].configure()):(t=new Ne,e.attachChild(t,"colorManager"),e.addToEnv("colorManager",t),t.configure()):(t&&(t[0].config.legendItemIds=[]),e.deleteFromEnv("colorManager"))}(e)};let He,ze,Xe,Ye={},Ue="rgba(192,192,192,"+(s.zb?.002:1e-6)+")",Je=!1,qe=!0,Ze="%",$e=",",Qe="#000000",et={}.hasOwnProperty,tt="M",ot="L";function rt(e,t){return function e(t,o){var r,a;for(a in t)et.call(t,a)&&(r=t[a],o[a]===He?o[a]=r:"object"==typeof r&&null!==r&&e(r,o[a]))}(e,t),t}function at(e){return Object(s.rb)(e||Qe)||Qe}function nt(e){var t,o=e.fontSize+"";return o?(t=o.replace(/(\d+)(px)*/,"$1px"),e.fontSize=t,e):e}function it(e){return!(e!==He&&null!=e&&!isNaN(e))}var lt,st;Ye.CAPTION="CAPTION",Ye.LEGEND_BODY="LEGEND_BODY",Ye.AXIS_LABEL="LEGEND_LABEL",Ye.LEGEND_AXIS="LEGEND_AXIS",Ye.RANGE="RANGE",Ye.AXIS_VALUE="AXIS_VALUE",(st={legendCarpetConf:{spreadFactor:.85,allowDrag:!1,captionAlignment:"center",padding:{v:3,h:3},style:{fill:"#e4d9c1",stroke:"#c4b89d"}},legendCaptionConf:{spreadFactor:.2,padding:{v:2,h:2},style:{fill:"#786B50",fontFamily:"sans-serif",fontSize:"12px",fontWeight:"bold",fontStyle:"normal"},bound:{style:{stroke:"none"}}},legendBodyConf:{spreadFactor:.8,padding:{v:2,h:2},bound:{style:{stroke:"none"}}}}).legendAxisConf={legendAxisHeight:11,spreadFactor:.4,padding:{v:1,h:1},style:{stroke:"none","stroke-opacity":0,"stroke-width":1},line:{grooveLength:3,offset:8,style:{stroke:"rgba(255, 255, 255, 0.65)","stroke-width":1.5}},shadow:{style:{stroke:"none",fill:Object(s.Vb)({FCcolor:{alpha:"25,0,0",angle:360,color:"000000,FFFFFF,FFFFFF",ratio:"0,30,40"}})}},bound:{style:{stroke:"none"}}},st.sliderGroupConf={showTooltip:1,outerCircle:{rFactor:1.4,style:{fill:Ue,stroke:"#757575","stroke-width":3}},innerCircle:{rFactor:.65,style:{fill:Ue,stroke:"#FFFFFF"}}},st.axisTextItemConf={spreadFactor:.3,padding:{v:1,h:1},style:{fill:"#786B50",fontFamily:"sans-serif",fontSize:"12px",fontWeight:"normal",fontStyle:"normal"}},ze={init:function(e){lt=e.chart},legacyDataParser:function(e,t){var o,r,a,n,i,l,c,h,d,g,p,b,u,f={},m=lt.getFromEnv("number-formatter");if(!e)return!1;for(f.mapByPercent=p=!!Object(s.Kb)(e.mapbypercent,0),o=e.color||[],e.minvalue===He&&(e.minvalue=t.min===He?0:p?0:t.min),e.maxvalue===He&&(e.maxvalue=t.max===He?100:p?100:t.max),b=!1,i=0,c=o.length;i<c;i++)if(o[i].maxvalue){b=!0;break}for(b||(o=[]),a=e.code,h=f.colorRange=[],f.gradient=!!Object(s.Kb)(e.gradient,1),o.length?a=at(a):(a?(n=at(a),a=at()):(u=a=at(),n=Object(s.jb)(u,1)),o.push({code:n,maxvalue:e.maxvalue,label:He})),function(e){var t,o,r,a=lt.getFromEnv("number-formatter");for(t=0,o=e.length;t<o;t++)(r=e[t].maxvalue)&&(e[t].maxvalue=a.getCleanValue(r))}(o),o=o.sort(function(e,t){return e.maxvalue-t.maxvalue}),d=g=e.minvalue&&m.getCleanValue(e.minvalue),g=(d!==He||null!==d)&&(p?d+Ze:m.legendValue(d)),h.push({code:Object(s.U)(a),value:d,displayValue:g,label:e.startlabel}),i=0,c=o.length;i<c;i++)l=at((r=o[i]).code||r.color),d=g=r.maxvalue,!isNaN(parseInt(d,10))&&(g=(d!==He||null!==d)&&(p?d+Ze:m.legendValue(d)),h.push({code:Object(s.U)(l),value:d,displayValue:g,label:r.label||r.displayvalue}));return h[h.length-1].label=e.endlabel||r.label,f},getDefaultConf:function(e){return st[e]}};class ct{constructor(e){this.carpet=e}draw(e){return this.carpet.draw(e)}getLogicalSpace(e,t){return this.carpet.getLogicalSpace(e,t)}dispose(){this.carpet&&this.carpet.group&&this.carpet.group.remove()}}class ht{constructor(e){this.conf=e,this._id="GL_CARPET",this.compositionsByCategory={},this.node=He,this.group=He,this._lSpace=He,this.autoRecalculate=!1,this.groupName="fc-gradient-legend",this.moveInstructions={}}configure(e){this.conf=e}getName(){return"LegendCarpet"}getType(){return"legend"}addCompositions(e,t){this.compositionsByCategory[t]=e}removeCompositions(e){delete this.compositionsByCategory[e]}getBoundingBox(e){var t,o,r=this.conf,a=r.spreadFactor,n=e.refSide,i=e.alignment,l=e.refOffset,s=e.x,c=e.y;return"bottom"===this.conf.legendPosition?(t=r.width=n*a,o=e.maxOtherSide,i&&(s===He||null===s)&&(s=(l+n)/2-t/2)):(o=r.height=n*a,t=e.maxOtherSide,i&&(c===He||null===c)&&(c=(l+n)/2-o/2)),{width:t,height:o,x:s,y:c}}getPostCalcDecisionsH(e,t){var o,r=this.conf.padding,a=0;for(o in this.moveInstructions={},t)a+=t[o].height||0;e.height=a+2*r.v}getLogicalSpace(e,t){var o,r,a,n,i,l=this._lSpace,s=["CAPTION","LEGEND_BODY"],c=this.conf.padding,h=this.compositionsByCategory,d=0,g={},p=0;if(l&&!t)return l.isImpure=!0,l;(it((l=this._lSpace=r=this.getBoundingBox(e)).x)||it(l.y)||it(l.height)||it(l.width))&&(this.autoRecalculate=!0),(a=rt(r,{})).height-=2*c.v,a.width-=2*c.h,a.x+=c.h,a.y+=c.v;for(let b=0;b<s.length;b++)(o=h[s[b]])&&((i=rt(a,{})).y+=d,i.height=(d=a.height*o.conf.spreadFactor)+p,n=o.getLogicalSpace(rt(i,{}),e,t),p=i.height-n.height,g[s[b]]=n,d=n.height);return this.getPostCalcDecisions(r,g),this._lSpace=r,r}setupDragging(){var e=this.group,t=0,o=0,r=0,a=0;e.css({cursor:"move"}),e.drag(function(n,i){e.attr({transform:"t"+(r+(t=n))+","+(a+(o=i))})},function(){r+=t,a+=o},s.Tb)}draw(e){var t,o,r,a=this.conf,n=["CAPTION","LEGEND_BODY"],i=this.compositionsByCategory,l=e.animationManager,s=e.parentGroup;this.getLogicalSpace(e,this.autoRecalculate),r=this._lSpace,this.group=t=l.setAnimation({el:this.group||"group",attr:{name:this.groupName},component:Xe,container:s,label:"carpetGroup"}),this.node=l.setAnimation({el:this.node||"rect",attr:r,css:a.style,component:Xe,container:t,label:"rect"});for(let c=0;c<n.length;c++)(o=i[n[c]])&&o.draw(a.captionAlignment,r,{animationManager:l,colorRange:e.colorRange,numberFormatter:e.numberFormatter,parentLayer:t,smartLabel:e.smartLabel,moveInstructions:this.moveInstructions[void 0],gLegend:e.gLegend});return a.allowDrag&&this.setupDragging(),this.node}getPostCalcDecisions(e,t){return"bottom"===this.conf.legendPosition?this.getPostCalcDecisionsH(e,t):this.getPostCalcDecisionsV(e,t)}getPostCalcDecisionsV(e,t){var o,r,a,n=this.conf.padding,i=Number.NEGATIVE_INFINITY,l=this.moveInstructions;for(r in this.getPostCalcDecisionsH(e,t),t)i=i<(o=t[r].width)?o:i;for(r in e.width=i+2*n.h,t)(a=i-(o=t[r].width))&&(l[r]="t"+a/2+",0")}}class dt{constructor(e,t){this.rawText=e,this.conf=t,this._id="GL_CAPTION",this.node=He,this.bound=He,this._lSpace=He,this.LegendCaption={},this.LegendCaption.LEFT={x:function(e,t){return t.x+e.width/2+2}},this.LegendCaption.RIGHT={x:function(e,t){return t.x+t.width-e.width/2-2}},this.LegendCaption.CENTER={x:function(){let e=arguments[1];return e.x+e.width/2}}}configure(e,t){this.rawText=e,this.conf=t}getName(){return"LegendCaption"}getType(){return"caption"}getLogicalSpace(e,t,o){var r,a,n,i,l=this.conf.padding,s=this._lSpace,c=this.rawText,h=t.gLegend.getFromEnv("chartConfig");return s&&!o?(s.isImpure=!0,s):(s=this._lSpace={bound:{height:0,width:0},node:{logicArea:He,smartText:He}},r=t.smartLabel,c?((a=rt(e,{})).height-=2*l.v,a.width-=2*l.h,a.x+=l.h,a.y+=l.v,r.useEllipsesOnOverflow(h.useEllipsesWhenOverflow),nt(i=rt(this.conf.style,{})),r.setStyle(this._metaStyle=i),n=r.getSmartText(c,a.width,a.height),a.height=n.height,a.width=n.width,e.height=n.height+2*l.v,e.width=n.width+2*l.h,s.node.smartText=n,s.node.logicArea=a,s.bound=e,e):s.bound)}draw(){var e,t,o,r,a,n,i,l,s,c=this.conf,h=c.bound||{};return 3<=arguments.length?(a=arguments[0],n=arguments[1],i=arguments[2]):2<=arguments.length&&(a=arguments[0],i=arguments[1]),this.group=e=(s=i.animationManager).setAnimation({el:this.group||"group",attr:{name:"legend-caption"},css:c.style,component:Xe,container:i.parentLayer}),this.getLogicalSpace(n,i),l=(o=this._lSpace).node,this.bound=t=s.setAnimation({el:this.bound||"rect",attr:o.bound,css:h.style,container:e,component:Xe}),r="string"==typeof a?this.LegendCaption[a.toUpperCase()].x(l.smartText,n||l.logicArea):a,this.node=s.setAnimation({el:this.node||"text",attr:{text:l.smartText.text,x:r,y:l.logicArea.y+l.smartText.height/2,lineHeight:this._metaStyle.lineHeight,fill:c.style.fill},container:e,component:Xe}),{group:e,bound:t,node:this.node}}dispose(){this.group.remove(),this.bound.remove(),this.node.remove()}}class gt{constructor(e,t,o){this.colorRange=e,this.conf=t,this.childTextConf=o,this._id="GL_BODY",this.bound=He,this.group=He,this.compositionsByCategory={},this._lSpace=He,this.SC_STACK=[Ye.AXIS_LABEL,Ye.LEGEND_AXIS,Ye.AXIS_VALUE],this.DARW_STACK=[Ye.AXIS_VALUE,Ye.LEGEND_AXIS,Ye.AXIS_LABEL]}configure(e,t,o){this.colorRange=e,this.conf=t,this.childTextConf=o,this.compositionsByCategory={}}getName(){return"LegendBody"}getType(){return"legend"}addCompositions(e,t){this.compositionsByCategory[t]=e}getSpaceTaken(e){return"bottom"===this.conf.legendPosition?e.height:e.width}getLogicalSpace(e,t,o){var r,a,n,i,l,s,c,h=this._lSpace,d=this.conf.padding,g=this.compositionsByCategory,p=0;if(h&&!o)return h.isImpure=!0,h;for(h=this._lSpace={bound:{height:0,width:0},node:{logicArea:He}},(i=rt(e,{})).height-=2*d.v,i.width-=2*d.h,i.x+=d.h,i.y+=d.v,l=this.getCompositionPlotAreaFor(i),t.colorRange=this.colorRange,s=0,c=this.SC_STACK.length;s<c;s++)(r=g[this.SC_STACK[s]])&&(a=l(n,r.conf.spreadFactor),n=r.getLogicalSpace(rt(a,{}),t,o),p+=this.getSpaceTaken(n));return this.updateEffectivePlotArea(e,i,p),h.node.logicArea=i,h.bound=e,e}draw(){var e,t,o,r,a,n,i,l,s,c,h=this.childTextConf,d=this.conf.bound.style||{},g=this.compositionsByCategory;for(3<=arguments.length?(n=arguments[1],l=arguments[2]):2<=arguments.length&&(l=arguments[1]),t=l.parentLayer,e=l.animationManager,this.getLogicalSpace(n,l),i=this._lSpace,this.group=a=e.setAnimation({el:this.group||"group",attr:{name:"legend-body",transform:"t0,0"},css:h.style,container:t,component:Xe}),this.bound=o=e.setAnimation({el:this.bound||"rect",attr:i.bound,css:d,container:a,component:Xe}),l.colorRange=this.colorRange,l.parentLayer=a,s=0,c=this.DARW_STACK.length;s<c;s++)(r=g[this.DARW_STACK[s]])&&r.draw(l);return l.moveInstructions&&a.attr({transform:l.moveInstructions}),{bound:o,group:a}}getCompositionPlotAreaFor(e){var t,o="bottom"===this.conf.legendPosition;return t=rt(e,{}),function(r,a){return r=r||{},o?(t.y+=r.height||0,t.height=e.height*a):(t.x+=r.width||0,t.width=e.width*a),t}}updateEffectivePlotArea(e,t,o){var r=this.conf.padding;"bottom"===this.conf.legendPosition?(t.height=o,e.height=o+2*r.v):(t.width=o,e.width=o+2*r.h)}}class pt{constructor(e){this.conf=e,this.node=[],this._id="GL_LABELS"}configure(e){this.conf=e}getType(){return"label"}getName(){return"LegendLabel"}getEffectivePlotArea(e){var t=this.conf.padding;return e.height-=2*t.v,e.width-=2*t.h,e.x+=t.h,e.y+=t.v,e}getLogicalSpace(e,t,o){var r,a,n,i,l,s,c,h,d,g,p,b,u,f,m,v,y,C,x,O,k,w,F=Math.max,j="bottom"===this.conf.legendPosition,A=this._lSpace,I=this.conf,L=I.padding,S=[],E=t.gLegend.getFromEnv("chartConfig"),_=[];if(A&&!o)return A.isImpure=!0,A;for(a=t.smartLabel,g=(r=t.colorRange).getCumulativeValueRatio(),n=r.colorRange,u=(A=this._lSpace={bound:{height:0,width:0},node:{logicArea:He,smartTexts:[]}}).node.smartTexts,h=rt(e,{}),m=this.getEffectivePlotArea(h),w=j?m.width:m.height,a.useEllipsesOnOverflow(E.useEllipsesWhenOverflow),k=rt(I.style,{}),nt(this._metaStyle=k),a.setStyle(k),v=a.getSmartText("W"),i=0,l=n.length;i<l;i++)(d=n[i].label)?_.push({oriIndex:i,label:d}):u[i]=He;if(0===(l=_.length))return{height:0,width:0};for(b=p=1<l?(g[_[l-1].oriIndex]-g[_[0].oriIndex])/2*w/100:F(g[_[0].oriIndex],100-g[_[0].oriIndex])/2*w/100,j?((x=a.getSmartText(_[0].label,b,m.height)).x=g[_[0].oriIndex]*m.width/100,s=x.x+x.width):((x=a.getSmartText(_[0].label,b,m.width)).y=g[_[0].oriIndex]*m.height/100,s=x.y+x.width),S.push(x.height),u[_[0].oriIndex]=x,j?((x=a.getSmartText(_[l-1].label,b,m.height)).x=g[_[l-1].oriIndex]*m.width/100,c=x.x-x.width):((x=a.getSmartText(_[l-1].label,b,m.width)).y=g[_[l-1].oriIndex]*m.height/100,c=x.y-x.width),S.push(x.height),u[_[l-1].oriIndex]=x,C=s,i=1;i<l-1;i++)d=_[i].label,O=_[i].oriIndex,x=He,y=g[_[i].oriIndex]*w/100,(p=Math.min(y-C,(i+1===l-1?c:g[_[i+1].oriIndex]*w/100)-y))>2*v.width&&(j?(x=a.getSmartText(d,p,m.height)).x=g[O]*m.width/100:(x=a.getSmartText(d,p,m.width)).y=g[O]*m.height/100,C=p,S.push(x.height)),u[_[i].oriIndex]=x;return f=F.apply(Math,S),j?(m.height=f,e.height=f+2*L.v):(m.width=f,e.width=f+2*L.v),A.node.logicArea=m,A.bound=e,e}draw(){var e,t,o,r,a,n,i,l,s,c,h,d,g="bottom"===this.conf.legendPosition,p=this.conf,b=p.bound&&p.bound.style||{stroke:"none"},u={};2<=arguments.length&&arguments[1]?(r=arguments[0],i=arguments[1]):1<=arguments.length&&(i=arguments[0]),d=i.animationManager,e=i.parentLayer,this.getLogicalSpace(r,i),s=(n=this._lSpace).node.logicArea,c=n.node.smartTexts,this.group=o=d.setAnimation({el:this.group||"group",attr:{name:"legend-labels"},container:e,component:Xe}),this.bound=t=d.setAnimation({el:this.bound||"rect",attr:n.bound,css:b,container:o,component:Xe});for(let f=0;f<this.node.length;f++)this.node[f].remove();for(this.node=[],l=0,h=c.length;l<h;l++)(a=c[l])&&(g?(u.y=s.y+a.height/2,u.x=l===h-1?s.x+a.x-a.width/2:l?s.x+a.x:s.x+a.x+a.width/2):(u.x=s.x+a.height/2,u.y=l===h-1?s.y+a.y-a.width/2:l?s.y+a.y:s.y+a.y+a.width/2),this.node.push(d.setAnimation({el:"text",attr:{text:a.text,x:u.x,y:u.y,lineHeight:this._metaStyle.lineHeight,fill:p.style.fill,transform:g?"R0":"R270,"+u.x+","+u.y},container:o,component:Xe})));return{group:o,bound:t,node:this.node}}}class bt{constructor(e){this.conf=e,this._id="FL_AXIS",this.node=He,this.group=He,this.shadow=He,this.markerLine=He,this.compositionsByCategory={}}configure(e){this.conf=e}getName(){return"LegendAxis"}getType(){return"axis"}addCompositions(e,t){this.compositionsByCategory[t]=e}getLogicalSpace(){var e,t,o,r,a,n="bottom"===this.conf.legendPosition,i=arguments[0],l=this._lSpace,s=this.conf,c=s.padding,h=s.legendAxisHeight,d=this.compositionsByCategory,g=0;return l&&!arguments[2]?(l.isImpure=!0,l):(l=this._lSpace={bound:{height:0,width:0},node:{logicArea:He}},(a=rt(i,{})).height-=2*c.v,a.width-=2*c.h,a.x+=c.h,a.y+=c.v,e=h/2+s.line.offset,t=h/2,(r=d[Ye.RANGE])&&(t+=g=Math.max(r.sliders.false.conf.outerCircle.rFactor*h/2-h/2,0)),n?(a.y+=g,a.height=o=t+e+g,i.height=o+2*c.v):(a.x+=g,a.width=o=t+e+g,i.width=o+2*c.v),l.node.logicArea=a,l.bound=i,i)}getDrawableAxisArea(e){var t=this.conf,o="bottom"===this.conf.legendPosition;return{x:e.x,y:e.y,width:o?e.width:t.legendAxisHeight,height:o?t.legendAxisHeight:e.height,r:t.legendAxisHeight/2}}preDrawingRangeParamV(e){return{x:e.x+e.width/2,calculationBase:e.width,rangeStart:e.y,rangeEnd:e.y+e.height,prop:"x"}}preDrawingRangeParamH(e){return{y:e.y+e.height/2,calculationBase:e.height,rangeStart:e.x,rangeEnd:e.x+e.width,prop:"y"}}preDrawingRangeParam(e){return"bottom"===this.conf.legendPosition?this.preDrawingRangeParamH(e):this.preDrawingRangeParamV(e)}getScaleMarkerPathStrH(e,t){var o,r,a,n,i=rt(e,{}),l=this.conf.line,s="";for(i.x+=i.r,i.width-=2*i.r,n=i.y+i.height,o=0,r=t.length;o<r;o++)s+=tt+(a=i.x+t[o]*i.width/100)+$e+(n-l.grooveLength)+ot+a+$e+(n+l.offset);return s+""+(tt+i.x+$e+(n+l.offset)+ot+(i.x+i.width)+$e+(n+l.offset))}getColorGradientH(e){return{axis:e.getBoxFill(),shadow:Object(s.Vb)({FCcolor:{alpha:"25,0,0",angle:90,color:"000000,FFFFFF,FFFFFF",ratio:"0,30,40"}})}}draw(){var e,t,o,r,a,n,i,l,s,c,h,d,g,p,b=this.conf,u=b.line,f=(b.bound||{}).style||{},m=this.compositionsByCategory;for(o in 2<=arguments.length?(t=arguments[0],d=arguments[1]):1<=arguments.length&&(d=arguments[0]),g=d.animationManager,e=d.parentLayer,a=(r=d.colorRange).getCumulativeValueRatio(),this.getLogicalSpace(t,d),h=this._lSpace,this.group=i=g.setAnimation({el:this.group||"group",attr:{name:"legend-axis"},container:e,component:Xe}),this.bound=g.setAnimation({el:this.bound||"rect",attr:h.bound,css:f,component:Xe,container:i}),c=this.getDrawableAxisArea(h.node.logicArea),s=this.getColorGradient(r),b.style.fill=s.axis,b.shadow.style.fill=s.shadow,this.node=g.setAnimation({el:this.node||"rect",attr:c,css:b.style,container:i,component:Xe}),this.shadow=g.setAnimation({el:this.shadow||"rect",attr:c,css:b.shadow.style,container:i,component:Xe}),p=this.getScaleMarkerPathStr(c,a),this.path=g.setAnimation({el:this.path||"path",attr:{path:p},css:u.style,container:i,component:Xe}),m)n=m[o],o===Ye.RANGE&&(d[(l=this.preDrawingRangeParam(c)).prop]=l[l.prop],d.key=l.prop,d.rCalcBase=l.calculationBase,d.parentLayer=i,n.draw(l.rangeStart,l.rangeEnd,d))}getScaleMarkerPathStr(e,t){return"bottom"===this.conf.legendPosition?this.getScaleMarkerPathStrH(e,t):this.getScaleMarkerPathStrV(e,t)}getColorGradient(e){return"bottom"===this.conf.legendPosition?this.getColorGradientH(e):this.getColorGradientV(e)}getScaleMarkerPathStrV(e,t){var o,r,a,n,i=rt(e,{}),l=this.conf.line,s="";for(i.y+=i.r,i.height-=2*i.r,a=i.x+i.width,o=0,r=t.length;o<r;o++)s+=tt+(a-l.grooveLength)+$e+(n=i.y+t[o]*i.height/100)+ot+(a+l.offset)+$e+n;return s+""+(tt+(a+l.offset)+$e+i.y+ot+(a+l.offset)+$e+(i.y+i.height))}getColorGradientV(e){return{axis:e.getBoxFill(!0),shadow:Object(s.Vb)({FCcolor:{alpha:"25,0,0",angle:360,color:"000000,FFFFFF,FFFFFF",ratio:"0,30,40"}})}}}class ut{constructor(e,t,o){this.conf=t.conf,this.sliderIndex=e,this.rangeGroup=t.sliderGroup,this._id=o,this.node=He,this.tracker=He,this.currPos=0,this.swing=[]}configure(e,t,o){this.conf=t.conf,this.sliderIndex=e,this.rangeGroup=t.sliderGroup,this._id=o,this.currPos=0,this.swing=[]}getType(){return"slider"}getName(){return"Slider"}updateSwingRange(e,t){this.swing[+e]=t}draw(e,t,o,r){var a,n,i,l,s,c,h=Math.ceil,d=r.parentLayer,g=r.animationManager,p=this.conf,b=p.outerCircle,u=p.innerCircle,f=g.getFromEnv("chart").config,m=h(b.rFactor*r.rCalcBase/2),v=h(u.rFactor*r.rCalcBase/2),y="L"-v,C=r.gLegend.getFromEnv("toolTipController"),x=this.sliderIndex;return p.outerRadius=m,p.innerRadius=v,this._scaleVal=t,u.style["stroke-width"]=y,v+=i=h(b.style["stroke-width"]/2),a=this.node=g.setAnimation({el:this.node||"group",attr:{name:"fc-gl-slider",cursor:"pointer",transform:"t0,0"},container:d,component:Xe}),"x"===r.key?(l=o,s=e,s+=x?-v:+v):(l=e,s=o,l+=x?-v:+v),this.oCircle=g.setAnimation({el:this.oCircle||"circle",attr:{cx:l,cy:s,r:m},css:b.style,container:a,component:Xe}),this.iCircle=g.setAnimation({el:this.iCircle||"circle",attr:{cx:l,cy:s,r:v},css:u.style,container:a,component:Xe}),c=this.tracker=g.setAnimation({el:this.tracker||"circle",attr:{cx:l,cy:s,r:m+5,fill:Ue,stroke:Ue,cursor:"pointer"},container:a,component:Xe}),a.attr({transform:"x"===r.key?"t0,"+this.currPos:"t"+this.currPos+",0"}),C.enableToolTip(c,f.showToolTip?t:""),this._dragAPI=n=this.getDragAPI("x"===r.key),c.undrag(),c.drag(n.dragging,n.dragStart,n.dragEnd),{translateAscending:m+i}}getDragAPI(e){var t,o,r,a,n=this,i=n.node,l=n.sliderIndex,s=n.rangeGroup,c=n.conf.innerRadius;return{dragging:function(h){var d,g,p,b,u;return h.stopPropagation(),l?(d=t[0]-t[1]+c,g=0):(d=0,g=t[1]-t[0]-c),(u=n.currPos+(p=e?h.data[1]:h.data[0]))<d?p+=d-u:u>g&&(p-=u-g),i.attr({transform:e?"t0,"+(n.currPos+p):"t"+(n.currPos+p)+",0"}),o=p,r&&clearTimeout(r),r=setTimeout(function(){s.updateWhenInRest(n,n.currPos+p)},100),b=s.updateWhenInMove(n,n.currPos+p),n.conf.showTooltip&&n.tracker.data("__FC_tooltipText",b),a=!0,!0},dragStart:function(e){e.stopPropagation(),t=n.swing,a=!1,s.dragStarted(n)},dragEnd:function(){s.dragCompleted(n,a,n.currPos+o),a&&(r&&clearTimeout(r),r=setTimeout(function(){s.updateWhenInRest(n,n.currPos)},100),n.currPos+=o,s.updateRange(n,t[+l]+n.currPos))}}}dispose(){this.node.remove(),this.oCircle.remove(),this.iCircle.remove(),this.tracker.remove()}}class ft{constructor(e){var t={};this._id="GL_SG1",this.conf=e,t.conf=e,this.extremes=[],this.sliders={},this.min=void 0,this.max=void 0,t.sliderGroup=this,this.valueRange=[],this.callbacks=[],this.sliders[Je]=new ut(Je,t,this._id+"_0"),this.sliders[qe]=new ut(qe,t,this._id+"_1")}configure(e){var t={};this.min=void 0,this.max=void 0,this.conf=e,t.conf=e,t.sliderGroup=this,this.sliders[Je].configure(Je,t,this._id+"_0"),this.sliders[qe].configure(qe,t,this._id+"_1")}getType(){return"slider"}getName(){return"SliderGroup"}initRange(e,t){this.extremes[+e.sliderIndex]=t}updateRange(e,t){var o=e.sliderIndex;this.sliders[!o].updateSwingRange(o,t)}reset(){var e={};e.conf=this.conf,e.sliderGroup=this,this.min=void 0,this.max=void 0,this.sliders[Je].configure(Je,e,this._id+"_0"),this.sliders[qe].configure(qe,e,this._id+"_1"),this.draw.apply(this,this._drawParams)}draw(e,t,o){var r,a,n,i,l,s=Math.ceil,c=this.sliders,h=c[!1],d=c[!0],g=o.colorRange,p=g.colorRange,b=g.data.mapByPercent,u=o.gLegend.getFromEnv("number-formatter");return this._fcChart=o.gLegend.getFromEnv("chart"),this.getValueFormPixel=function(e,t,o,r){this.getValueFormPixel=function(a){return e+(t-e)/(r-o)*a}},this.updateWhenInMove=function(e,t){this.updateWhenInMove=function(o,r){var a,n=this.extremes;return a=this.getValueFormPixel(o.sliderIndex?n[1]-n[0]+r:r),t?parseFloat(a).toFixed(2)+Ze:e.legendValue(a)}},this._drawParams=[e,t,o],this.updateWhenInMove(u,b),a=h.conf.outerCircle,n=s(h.conf.innerCircle.rFactor*o.rCalcBase/2),n+=s(a.style["stroke-width"]/2),this.extremes[0]=e+n,this.extremes[1]=t-n,i=this.extremes[1]-this.extremes[0],this.min=this.min?this.min:p[0].value,this.max=this.max?this.max:p[p.length-1].value,h.currPos=i*(this.min-p[0].value)/(l=p[p.length-1].value-p[0].value),d.currPos=i*(this.max-p[0].value)/l-i,h.draw(e,b?u.legendPercentValue(this.min):u.legendValue(this.min),o[o.key],o),r=d.draw(t,b?u.legendPercentValue(this.max):u.legendValue(this.max),o[o.key],o),h.swing=this.extremes.slice(0),d.swing=this.extremes.slice(0),h.swing[1]+=d.currPos,d.swing[0]+=h.currPos,this.getValueFormPixel(p[0].value,p[p.length-1].value,this.extremes[0],this.extremes[1]),r}updateWhenInRest(e,t){var o,r,a=this.sliders,n=this.extremes,i=e.sliderIndex;i?(o=a[!i].currPos,r=n[1]-n[0]+t):(o=t,r=n[1]-n[0]+a[!i].currPos),this.min=+this.getValueFormPixel(o).toFixed(2),this.max=+this.getValueFormPixel(r).toFixed(2),this.gLegend.fireEvent("rangeUpdated",[{min:this.min,max:this.max}])}dragStarted(e){var t=this.sliders,o=this.extremes,r=e.conf,a=this._fcChart;a.fireChartInstanceEvent("legendpointerdragstart",{pointerIndex:+e.sliderIndex,pointers:[{value:this.getValueFormPixel(t.false.currPos)},{value:this.getValueFormPixel(o[1]-o[0]+t.true.currPos)}],legendPointerHeight:r.outerRadius,legendPointerWidth:r.innerRadius,outerRadius:r.outerRadius,innerRadius:r.innerRadius},[a.id])}dragCompleted(e,t,o){var r,a,n=this.sliders,i=this.extremes,l=e.conf,s=this.getValueFormPixel(n.false.currPos),c=this.getValueFormPixel(i[1]-i[0]+n.true.currPos),h=this._fcChart;e.sliderIndex?(r=s,a=this.getValueFormPixel(i[1]-i[0]+o)):(r=this.getValueFormPixel(o),a=c),t&&h.fireChartInstanceEvent("legendrangeupdated",{previousMinValue:s,previousMaxValue:c,minValue:r,maxValue:a},[h.id]),h.fireChartInstanceEvent("legendpointerdragstop",{pointerIndex:+e.sliderIndex,pointers:[{value:r},{value:a}],legendPointerHeight:l.outerRadius,legendPointerWidth:l.innerRadius,outerRadius:l.outerRadius,innerRadius:l.innerRadius},[h.id])}dispose(){this.sliders[Je].dispose(),this.sliders[qe].dispose()}}class mt extends pt{constructor(){super(arguments[0]),this._id="GL_VALUES",this.node=[]}configure(e){this.conf=e}getName(){return"LegendValues"}getType(){return"legend"}getLogicalSpace(e,t,o){var r,a,n,i,l,s,c,h,d,g,p,b,u,f,m,v,y,C,x,O,k,w,F,j,A=Math.min,I=Math.max,L="bottom"===this.conf.legendPosition,S=this._lSpace,E=this.conf,_=E.padding,P=t.gLegend.getFromEnv("chartConfig"),T=[],R=[];if(S&&!o)return S.isImpure=!0,S;for(a=t.smartLabel,n=(r=t.colorRange).colorRange,c=r.getCumulativeValueRatio(),j=(S=this._lSpace={bound:{height:0,width:0},node:{logicArea:He,smartTexts:[]}}).node.smartTexts,(x=rt(e,{})).height-=2*_.v,x.width-=2*_.h,x.x+=_.h,x.y+=_.v,a.useEllipsesOnOverflow(P.useEllipsesWhenOverflow),F=rt(E.style,{}),nt(this._metaStyle=F),a.setStyle(F),w=a.getSmartText("W"),s=n.length,L?(g=h=(c[s-1]-c[0])/2*x.width/100,(i=a.getSmartText("string"!=typeof(k=n[0].displayValue)&&k!==He&&k.toString()||k,g,x.height)).x=c[0]*x.width/100,p=i.x+i.width,T.push(i.height)):(g=h=(c[s-1]-c[0])/2*x.height/100,(i=a.getSmartText(n[0].displayValue,x.width,g)).y=c[0]*x.height/100,f=i.y+i.width,R.push(i.width)),j[0]=i,L?((i=a.getSmartText(n[s-1].displayValue,g,x.height)).x=c[s-1]*x.width/100,u=i.x-i.width,T.push(i.height),b=p):((i=a.getSmartText(n[s-1].displayValue,x.width,g)).y=c[s-1]*x.height/100,v=i.y-i.height,R.push(i.width),m=f),j[s-1]=i,l=1;l<s-1;l++)i=He,O=n[l].displayValue,L?(h=A((d=c[l]*x.width/100)-b,(l+1===s-1?u:c[l+1]*x.width/100)-d))>1.5*w.width&&((i=a.getSmartText(O,2*h,x.height)).x=c[l]*x.width/100,b=h,T.push(i.height)):(h=A((d=c[l]*x.height/100)-m,(l+1===s-1?v:c[l+1]*x.height/100)-d))>2*w.height&&((i=a.getSmartText(O,x.width,2*h)).y=c[l]*x.height/100,m=h,R.push(i.width)),j[l]=i;return L?(y=I.apply(Math,T),x.height=y,e.height=y+2*_.v):(C=I.apply(Math,R),x.width=C,e.width=C+2*_.h),S.node.logicArea=x,S.bound=e,e}draw(){var e,t,o,r,a,n,i,l,s,c,h,d,g,p=this.conf,b="bottom"===p.legendPosition,u=p.bound&&p.bound.style||{stroke:"none"},f={};2<=arguments.length&&arguments[1]?(r=arguments[0],i=arguments[1]):1<=arguments.length&&(i=arguments[0]),g=i.animationManager,e=i.parentLayer,l=i.colorRange.getCumulativeValueRatio(),this.getLogicalSpace(r,i),n=(a=this._lSpace).node.logicArea,h=a.node.smartTexts,this.group=o=g.setAnimation({el:this.group||"group",attr:{name:"legend-values"},container:e,component:Xe}),this.bound=t=g.setAnimation({el:this.bound||"rect",attr:a.bound,css:u,container:o,component:Xe});for(let m=0;m<this.node.length;m++)this.node[m].remove();for(this.node=[],s=0,c=l.length;s<c;s++)(d=h[s])&&(b?(f.y=n.y+d.height/2,f.x=s===c-1?n.x+d.x-d.width/2:s?n.x+d.x:n.x+d.x+d.width/2):(f.x=n.x+d.width/2,f.y=s===c-1?n.y+d.y-d.height/2:s?n.y+d.y:n.y+d.y+d.height/2),this.node.push(g.setAnimation({el:"text",attr:{text:d.text,x:f.x,y:f.y,lineHeight:this._metaStyle.lineHeight,fill:p.style.fill},container:o,component:Xe})));return{group:o,bound:t}}}var vt=class extends a.a{getType(){return"gradientLegend"}getName(){return"gLegend"}constructor(){super(),Xe=this,this.enabled=!1,this.drawOptions={},this.components={}}setColorRange(e){let t=this.drawOptions.colorRange=e;t&&t._preparationGoneWrong&&(this._dontPlot=!0)}configureAttributes(){var e,t,o,r,a,n,i,l,c,h,d=this,g=d.getFromEnv("chart"),p=d.getFromEnv("dataSource").chart,b=d.conf={},u=p.outcnvbasefont,f=p.outcnvbasefontsize,m=p.outcnvbasefontcolor,v=g.config.dataLabelStyle;ze.init({chart:g}),d.data=d.getFromEnv("dataSource").colorrange,d._dontPlot||(d.drawOptions={smartLabel:d.getFromEnv("smartLabel"),gLegend:d},d._dontPlot=!1,d._recalculateLogicalSpace=!0,b.caption=Object(s.Ib)(p.legendcaption),b.legendPosition=Object(s.Ib)(p.legendposition,"bottom").toLowerCase(),b.showLegend=Object(s.Kb)(p.showlegend,1),b.interactiveLegend=Object(s.Kb)(p.interactivelegend,1),b.showLegendLabels=Object(s.Kb)(p.showlegendlabels,1),e=p.legenditemfontcolor||m,t=p.legenditemfont||u,o=p.legenditemfontsize||f,r=Object(s.Kb)(p.legenditemfontbold,0),a=p.legendcaptionfontcolor||m,n=p.legendcaptionfont||u,i=p.legendcaptionfontsize||f,l=Object(s.Kb)(p.legendcaptionfontbold,1),h=(c=p.legendaxisbordercolor?Object(s.vb)(Object(s.U)(p.legendaxisbordercolor)):He)?Object(s.Kb)(p.legendaxisborderalpha,100)/100:He,b.axisTextItemConf={style:{fill:e?Object(s.P)(Object(s.Ib)(e)):v.color,fontFamily:t?Object(s.Ib)(t):v.fontFamily,fontSize:o?Object(s.Kb)(o):v.fontSize.match(/\d+/)[0],fontWeight:r?"bold":v.fontWeight}},b.legendCaptionConf={style:{fill:a?Object(s.P)(Object(s.Ib)(a)):v.color,fontFamily:n?Object(s.Ib)(n):v.fontFamily,fontSize:i?Object(s.Kb)(i):v.fontSize.match(/\d+/)[0],fontWeight:l?"bold":v.fontWeight,fontStyle:"normal"}},b.legendAxisConf={legendAxisHeight:11,style:{stroke:c,"stroke-opacity":h},line:{style:{stroke:Object(s.P)(Object(s.Ib)(p.legendscalelinecolor,"FFF8E9"),Object(s.Kb)(p.legendscalelinealpha,100)),"stroke-width":Object(s.Kb)(p.legendscalelinethickness)}}},b.sliderGroupConf={showTooltip:Object(s.Kb)(p.showtooltip,1),outerCircle:{rFactor:Object(s.Kb)(p.sliderdiameterfactor),style:{stroke:Object(s.P)(Object(s.Ib)(p.legendpointerbordercolor,"757575"),Object(s.Kb)(p.legendpointerborderalpha,100))}},innerCircle:{rFactor:Object(s.Kb)(p.sliderholediameterfactor),style:{stroke:Object(s.P)(Object(s.Ib)(p.legendpointercolor,"FFFFFF"),Object(s.Kb)(p.legendpointeralpha,100))}}},b.legendCarpetConf={spreadFactor:Object(s.Kb)(p.legendspreadfactor),allowDrag:!!Object(s.Kb)(p.legendallowdrag,0),captionAlignment:Object(s.Ib)(p.legendcaptionalignment,"center"),style:{fill:Object(s.P)(Object(s.Ib)(p.legendbgcolor,"e4d9c1"),Object(s.Kb)(p.legendbgalpha,100)),stroke:Object(s.P)(Object(s.Ib)(p.legendbordercolor,"c4b89d"),Object(s.Kb)(p.legendborderalpha,100)),"stroke-width":Object(s.Kb)(p.legendborderthickness,1)}})}postConfigureInit(){var e,t,o,r,a,n,i,l,s,c,h,d=this,g=d.conf;d.elem={},g.interactiveLegend?(r=rt(ze.getDefaultConf("sliderGroupConf"),g.sliderGroupConf),this.sGroup?((o=d.elem.sGroup=this.sGroup).configure(r),d.elem.sGroup.gLegend=d):(this.sGroup=d.elem.sGroup=o=new ft(r),o.configure(r),d.elem.sGroup.gLegend=d)):(this.sGroup&&this.sGroup.dispose(),this.sGroup&&delete this.sGroup),(r=rt(ze.getDefaultConf("legendCarpetConf"),g.legendCarpetConf)).legendPosition=g.legendPosition,h=ze.getDefaultConf("legendBodyConf"),"bottom"===g.legendPosition?(d.drawOptions.refSideKey="canvasWidth",d.drawOptions.refOffsetKey="canvasLeft",a=rt(ze.getDefaultConf("axisTextItemConf"),g.axisTextItemConf),h.legendPosition="bottom",(c=rt(ze.getDefaultConf("legendAxisConf"),g.legendAxisConf)).legendPosition="bottom",a.legendPosition="bottom"):(d.drawOptions.refSideKey="canvasHeight",d.drawOptions.refOffsetKey="canvasTop",a=rt(ze.getDefaultConf("axisTextItemConf"),g.axisTextItemConf),h.legendPosition="right",(c=rt(ze.getDefaultConf("legendAxisConf"),g.legendAxisConf)).legendPosition="right",a.legendPosition="right"),Object.keys(this.components).length||(this.components.LegendCarpet=new ht,this.components.LegendBody=new gt,this.components.LegendAxis=new bt,this.components.LegendValues=new mt,g.showLegendLabels&&(this.components.LegendLabels=new pt)),t=this.components.LegendAxis,l=this.components.LegendValues,e=this.components.LegendCarpet,n=this.components.LegendBody,g.showLegendLabels&&(i=this.components.LegendLabels),this.components.LegendCarpet.configure(r),this.components.LegendValues.configure(a),this.components.LegendAxis.configure(c),this.components.LegendBody.configure(d.drawOptions.colorRange,h,a),g.showLegendLabels&&i.configure(a),g.caption?(s=rt(ze.getDefaultConf("legendCaptionConf"),g.legendCaptionConf),this.componentCaption&&Object.keys(this.componentCaption).length?this.componentCaption.configure(g.caption,s):(this.componentCaption=new dt).configure(g.caption,s),e.addCompositions(this.componentCaption,Ye.CAPTION)):(e.removeCompositions(Ye.CAPTION),this.componentCaption&&this.componentCaption.dispose(),delete this.componentCaption),o&&t.addCompositions(o,Ye.RANGE),i&&n.addCompositions(i,Ye.AXIS_LABEL),n.addCompositions(t,Ye.LEGEND_AXIS),n.addCompositions(l,Ye.AXIS_VALUE),e.addCompositions(n,Ye.LEGEND_BODY),d.elem.gl=new ct(e)}getValueRange(){var e,t=this.elem&&this.elem.sGroup,o=t.sliders,r=t.extremes;return e=r[1]-r[0]+o.true.currPos,[{min:t.getValueFormPixel(o.false.currPos),max:t.getValueFormPixel(e)}]}_dispose(){var e=this;e.elem&&e.elem.gl&&e.elem.gl.dispose(),e.elem={},super._dispose()}getCalculatedLogicalSpace(){return this._logicalArea}setCalculatedLogicalSpace(e){this._logicalArea=e}getLogicalSpace(e){var t,o,r=this,a=r.conf,n={height:0,width:0},i=r.drawOptions,l=r.getFromEnv("chartConfig");return r._recalculateLogicalSpace?r._dontPlot?n:(r._recalculateLogicalSpace=!1,r.postConfigureInit(),a.showLegend?(o=i.refOffsetKey,r.drawOptions.refSide=l[i.refSideKey],r.drawOptions.refOffset=l[o],r.drawOptions.maxOtherSide=e||r.drawOptions.maxOtherSide,r.elem.gl&&(t=r.elem.gl.getLogicalSpace(r.drawOptions,!0),r.elem.gl&&r.setCalculatedLogicalSpace(t)),r.getCalculatedLogicalSpace()):n):(o=i.refOffsetKey,r.drawOptions.refSide=l[i.refSideKey],r.drawOptions.refOffset=l[o],r.drawOptions.maxOtherSide=e||r.drawOptions.maxOtherSide,t=r.elem.gl.getLogicalSpace(r.drawOptions,!0),r.setCalculatedLogicalSpace(t),r.getCalculatedLogicalSpace()||n)}resetLegend(){var e;(e=this.elem&&this.elem.sGroup)&&e.reset()}allocatePosition(){var e,t,o,r,a,n,i=this.getFromEnv("chart"),l=i.config,s=this.conf||{},c=s.legendPosition,h=l.canvasLeft,d=l.canvasTop,g=l.canvasWidth,p=l.canvasHeight,b=l.marginBottom,u=l.marginRight;i.config.gLegendEnabled&&(e=this.getCalculatedLogicalSpace(),o=s.width=e.width,r=s.height=e.height,"bottom"===c?(a=h+(0>(t=g-o)?0:t/2),n=l.height-e.height-b-(l.actionBarHeight||0)):(n=d+(0>(t=p-r)?0:t/2),a=l.width-e.width-u),s.xPos=a,s.yPos=n)}draw(){var e=this.getFromEnv("chart"),t=e.getFromEnv("dataSource").colorrange,o=this.conf||{};!e.config.gLegendEnabled||t&&e.hasGradientLegend&&this.drawLegendComponent(o.xPos,o.yPos,{parentGroup:e.getContainer("parentgroup"),animationManager:e.getFromEnv("animationManager")})}drawLegendComponent(e,t,o){var r,a=this,n=a.conf;return a._dontPlot?void 0:n.showLegend?(a.drawOptions.animationManager=o.animationManager,a.drawOptions.parentGroup=o.parentGroup,a.drawOptions.x=e,a.drawOptions.y=t,a.drawOptions.maxOtherSide=a.drawOptions.maxOtherSide||o.maxOtherSide,r=a.elem.gl.draw(a.drawOptions).getBBox(),n.xPos=r.x,n.yPos=r.y,n.height=r.height,n.width=r.width,void(a.enabled=!0)):void(a.enabled=!1)}},yt=o("sEhd"),Ct=function(e){!function(e){let t,o=e.getFromEnv("dataSource").colorrange,r=e.getFromEnv("dataSource").chart.mapbycategory,a="maps"===e.defaultDatasetType,n="TreeMap"===e.getName(),i=e.getFromEnv("legend"),l=e.getFromEnv("gLegend");"gradient"==(t=o&&e.config.showLegend?a?o.gradient&&+o.gradient?"gradient":o.color?"icon":"none":n?o.gradient&&"0"!=o.gradient?"gradient":"none":o.gradient&&"0"!=o.gradient&&!+r?"gradient":"icon":"none")?(e.deleteFromEnv("legend"),i&&i.remove(),Object(s.O)(e,vt,"gLegend",1),(l=e.getChildren("gLegend")[0]).configure(),e.addToEnv("gLegend",l)):"icon"===t?(e.deleteFromEnv("gLegend"),l&&l.remove(),Object(s.O)(e,yt.a,"legend",1,{showLegend:!0}),(i=e.getChildren("legend")[0]).configure(),e.addToEnv("legend",i)):"none"===t&&(e.deleteFromEnv("gLegend"),e.deleteFromEnv("legend"),l&&l.remove(),i&&i.remove())}(e)};let xt,Ot=Object(s.W)({foregroundcolor:"333333",foregroundalpha:"100",foregrounddarkcolor:"111111",foregrounddarkalpha:"100",foregroundlightcolor:"666666",foregroundlightalpha:"100",backgroundlightcolor:"FFFFFF",backgroundlightalpha:"100",backgroundlightangle:90,backgroundlightratio:"",backgroundcolor:"FFFFCC",backgroundalpha:"100",backgrounddarkcolor:"ffcc66",backgrounddarkalpha:"100",backgrounddarkangle:270,backgrounddarkratio:"",shadow:1},n),kt="0,100",wt={basefontcolor:"foregroundcolor",bordercolor:"foregrounddarkcolor",borderalpha:"foregrounddarkalpha",bgcolor:"backgroundlightcolor",bgalpha:"backgroundlightalpha",bgangle:"backgroundlightangle",bgratio:"backgroundlightratio",canvasbordercolor:"foregrounddarkcolor",canvasborderalpha:"foregrounddarkalpha",canvasbgcolor:"backgroundlightcolor",canvasbgalpha:"backgroundlightalpha",canvasbgangle:"backgroundlightangle",canvasbgratio:"backgroundlightratio",tooltipbordercolor:"foregrounddarkcolor",tooltipborderalpha:"foregrounddarkalpha",tooltipbgcolor:"backgroundlightcolor",tooltipbgalpha:"backgroundlightalpha",tooltipfontcolor:"foregroundcolor",legendbordercolor:"foregrounddarkcolor",legendborderalpha:"foregrounddarkalpha",markerbordercolor:"foregroundlightcolor",markerborderalpha:"foregroundlightalpha",markerfillcolor:"backgrounddarkcolor",markerfillalpha:"backgrounddarkalpha",markerfillangle:"backgrounddarkangle",markerfillratio:"backgrounddarkratio",plotfillcolor:"backgroundcolor",plotfillalpha:"backgroundalpha",plotfillangle:"backgroundangle",plotfillratio:"backgroundratio",plothoverfillcolor:"backgrounddarkcolor",plothoverfillalpha:"backgrounddarkalpha",plothoverfillangle:"backgrounddarkangle",plothoverfillratio:"backgrounddarkratio",plotbordercolor:"foregroundcolor",plotborderalpha:"foregroundalpha",shadow:"shadow"},Ft={getMapName:function(){return this.jsVars.instanceAPI.getName().toLowerCase()},getEntityList:function(){let e,t,o,r,a,n,i,l=this.jsVars.instanceAPI.getDatasets()||[],s=l.length,c=[];for(e=0;e<s;e++)if("entities"===(i=(o=l[e]||[]).getName())){t=o;break}for(e in s=(r=t.components.data).length,r)r.hasOwnProperty(e)&&c.push({id:(n=(a=r[e]||{}).config||{}).id,originalId:n.originalId||n.id,label:n.label,shortlabel:n.shortLabel,value:n.value,formattedValue:n.formattedValue,toolText:n.toolText});return c},getMapAttribute:function(){return Object(l.f)(this,"12061210581","run","JavaScriptRenderer~getMapAttribute()",'Use of deprecated "getMapAttribute()". Replace with "getChartAttribute()".'),this.getChartAttribute.apply(this,arguments)},exportMap:function(){let e=this;return Object(l.f)(this,"12061210581","run","JavaScriptRenderer~exportMap()",'Use of deprecated "exportMap()". Replace with "exportChart()".'),e.exportChart&&e.exportChart.apply(e,arguments)},addMarker:function(e){let t,o,r,a,n=this.jsVars.instanceAPI.getDatasets()||[],i=n.length;for(t=0;t<i;t++)if("markers"===(a=(o=n[t]||[]).getName())){r=o;break}r&&!r.addMarkerItem(e)&&Object(l.f)(this,"1309264086","run","MapsRenderer~addMarker()","Failed to add marker. Check the options and try again.")},updateMarker:function(e,t){let o,r,a,n,i=this.jsVars.instanceAPI.getDatasets()||[],l=i.length;for(o=0;o<l;o++)if("markers"===(n=(r=i[o]||[]).getName())){a=r;break}a&&e&&(e=(e+It).toLowerCase(),a.updateMarkerItem(e,t))},removeMarker:function(e){let t,o,r,a,n=this.jsVars.instanceAPI.getDatasets()||[],i=n.length;for(t=0;t<i;t++)if("markers"===(a=(o=n[t]||[]).getName())){r=o;break}e&&(e=(e+It).toLowerCase(),r._removeMarkerItem(e))}},jt="none",At=", ",It="",Lt="bottom",St="circle",Et=window.Math,_t=Et.min,Pt=Et.max,Tt=function(e,t){let o=Object(s.lb)(t.getFromEnv("chart-container"),e,t),r=o.chartX,a=o.chartY,n=t.config,i=n.canvasLeft,l=n.canvasTop,c=n.canvasLeft+n.canvasWidth,h=n.canvasHeight+n.canvasTop;return o.insideCanvas=!1,o.originalEvent=e,r>i&&r<c&&a>l&&a<h&&(o.insideCanvas=!0),o};class Rt extends a.a{constructor(e,t){for(var o in super(),this.subpalette="",this.key="",this.index=t,e)this.subpalette=Ot[e[o]],this[o]=this.subpalette instanceof Array?this.subpalette[t]:this.subpalette,this.key=o}}class Mt extends r.a{constructor(){super(),this.friendlyName="Map",this.revision=1,this.hasCanvas=!0,this.standaloneInit=!1,this.defaultDatasetType="maps",this.defaultSeriesType="geo",this.fireGroupEvent=!0,this.legendposition="right",this.hasGradientLegend=!0,this.isMap=!0,this.defaultPaletteOptions={paletteColors:[["A6A6A6","CCCCCC","E1E1E1","F0F0F0"],["A7AA95","C4C6B7","DEDFD7","F2F2EE"],["04C2E3","66E7FD","9CEFFE","CEF8FF"],["FA9101","FEB654","FED7A0","FFEDD5"],["FF2B60","FF6C92","FFB9CB","FFE8EE"]],bgColor:["FFFFFF","CFD4BE,F3F5DD","C5DADD,EDFBFE","A86402,FDC16D","FF7CA0,FFD1DD"],bgAngle:[270,270,270,270,270],bgRatio:[kt,kt,kt,kt,kt],bgAlpha:["100","60,50","40,20","20,10","30,30"],toolTipBgColor:["FFFFFF","FFFFFF","FFFFFF","FFFFFF","FFFFFF"],toolTipBorderColor:["545454","545454","415D6F","845001","68001B"],baseFontColor:["555555","60634E","025B6A","A15E01","68001B"],tickColor:["333333","60634E","025B6A","A15E01","68001B"],trendColor:["545454","60634E","415D6F","845001","68001B"],plotFillColor:["545454","60634E","415D6F","845001","68001B"],borderColor:["767575","545454","415D6F","845001","68001B"],borderAlpha:[50,50,50,50,50]},this.colorPaletteMap=wt,this.eiMethods=Ft,this.registerFactory("legend",Ct,["canvas"]),this.registerFactory("axis",()=>{},["canvas"]),this.registerFactory("colormanager-decider",We,["legend"]),this.registerFactory("dataset",_e,["colormanager-decider"]),this.registerFactory("canvas",Pe.a)}_checkInvalidSpecificData(){return this.config.invalid=!1,!1}__setDefaultConfig(){super.__setDefaultConfig();var e=this.config;e.baseWidth||(e.baseWidth=400),e.baseHeight||(e.baseHeight=300),e.baseScaleFactor||(e.baseScaleFactor=1)}static getName(){return"maps"}static getType(){return"chartAPI"}getName(){return this.config.name||"GEO"}getType(){return"chartAPI"}configureAttributes(e){let t,o=this,r=o.getChildren("colorPalette")&&o.getChildren("colorPalette")[0];t=e.chart=e.chart||e.graph||e.map||{},o.jsonData=e,r||(r=new Rt(this.colorPaletteMap,(0<t.palette&&6>t.palette?t.palette:Object(s.Kb)(o.paletteIndex,1))-1),o.attachChild(r,"colorPalette")),o.config.skipCanvasDrawing=!0,super.configureAttributes(e),o._parseBackgroundCosmetics()}parseChartAttr(e){let t,o,r,a,n,i=this,l=i.jsonData,c=l.chart||l.map,h=l.markers,d=new Rt(this.colorPaletteMap,(0<c.palette&&6>c.palette?c.palette:Object(s.Kb)(i.paletteIndex,1))-1),g=Object(s.Ib)(c.entitybordercolor,c.bordercolor,d.plotbordercolor),p=Object(s.Ib)(c.entityfillcolor,c.fillcolor,d.plotfillcolor),b=Object(s.Ib)(c.entityfillalpha,c.fillalpha,d.plotfillalpha),u=Object(s.Ib)(c.entityfillratio,c.fillratio,d.plotfillratio),f=Object(s.Ib)(c.entityfillangle,c.fillangle,d.plotfillangle),m=Object(s.Ib)(c.nullentityfillcolor,c.nullentitycolor,p),v=Object(s.Kb)(c.usevaluesformarkers,l.markers&&l.markers.items&&l.markers.items.length,!(l.markers&&l.markers.application&&l.markers.application.length&&l.markers.definition&&l.markers.definition.length));super.parseChartAttr(e),(t=i.config).origMarginTop=Object(s.Kb)(c.charttopmargin,c.maptopmargin,11),t.origMarginLeft=Object(s.Kb)(c.chartleftmargin,c.mapleftmargin,11),t.origMarginBottom=Object(s.Kb)(c.chartbottommargin,c.mapbottommargin,11),t.origMarginRight=Object(s.Kb)(c.chartrightmargin,c.maprightmargin,11),t.labelsOnTop=Object(s.Kb)(c.entitylabelsontop,1),o=(n=t.style).inCancolor,t.entityOpts={baseScaleFactor:t.baseScaleFactor,dataLabels:{style:{fontFamily:r=n.inCanfontFamily,fontSize:a=n.inCanfontSize,lineHeight:n.inCanLineHeight,color:n.inCancolor}},fillColor:p,fillAlpha:b,fillRatio:u,fillAngle:f,borderColor:g,borderAlpha:Object(s.Ib)(c.entityborderalpha,c.borderalpha,i.borderAlpha,"100"),borderThickness:Object(s.Kb)(c.showentityborder,c.showborder,1)?Object(s.Kb)(c.entityborderthickness,c.borderthickness,1):0,scaleBorder:Object(s.Kb)(c.scaleentityborder,c.scaleborder,0),hoverFillColor:Object(s.Ib)(c.entityfillhovercolor,c.hoverfillcolor,c.hovercolor,d.plothoverfillcolor),hoverFillAlpha:Object(s.Ib)(c.entityfillhoveralpha,c.hoverfillalpha,c.hoveralpha,d.plothoverfillalpha),hoverFillRatio:Object(s.Ib)(c.entityfillhoverratio,c.hoverfillratio,c.hoverratio,d.plothoverfillratio),hoverFillAngle:Object(s.Ib)(c.entityfillhoverangle,c.hoverfillangle,c.hoverangle,d.plothoverfillangle),hoverBorderThickness:Object(s.Ib)(c.entityborderhoverthickness,c.hoverborderthickness),hoverBorderColor:Object(s.Ib)(c.entityborderhovercolor,g,d.plotbordercolor),hoverBorderAlpha:Object(s.Ib)(c.entityborderhoveralpha,d.plotborderalpha),nullEntityColor:m,nullEntityAlpha:Object(s.Ib)(c.nullentityfillalpha,c.nullentityalpha,b),nullEntityRatio:Object(s.Ib)(c.nullentityfillratio,c.nullentityratio,u),nullEntityAngle:Object(s.Ib)(c.nullentityfillangle,c.nullentityangle,f),connectorColor:Object(s.Ib)(c.labelconnectorcolor,c.connectorcolor,o),connectorAlpha:Object(s.Ib)(c.labelconnectoralpha,c.connectoralpha,"100"),connectorThickness:Object(s.Kb)(c.labelconnectorthickness,c.borderthickness,1),showHoverEffect:Object(s.Kb)(c.showentityhovereffect,c.usehovercolor,c.showhovereffect,1),hoverOnNull:Object(s.Kb)(c.hoveronnull,c.entityhoveronnull,1),labelPadding:Object(s.Kb)(c.labelpadding,5),showLabels:Object(s.Kb)(c.showlabels,1),labelsOnTop:Object(s.Kb)(c.entitylabelsontop,1),includeNameInLabels:Object(s.Kb)(c.includenameinlabels,1),includeValueInLabels:Object(s.Kb)(c.includevalueinlabels,0),useSNameInTooltip:Object(s.Kb)(c.usesnameintooltip,0),useShortName:Object(s.Kb)(c.usesnameinlabels,1),labelSepChar:Object(s.Ib)(c.labelsepchar,At),showTooltip:Object(s.Kb)(c.showentitytooltip,c.showtooltip,1),tooltipSepChar:Object(s.Ib)(c.tooltipsepchar,", "),tooltext:c.entitytooltext,hideNullEntities:Object(s.Kb)(c.hidenullentities,0),showHiddenEntityBorder:Object(s.Kb)(c.showhiddenentityborder,1),showNullEntityBorder:Object(s.Kb)(c.shownullentityborder,1),hiddenEntityColor:Object(s.Ib)(c.hiddenentitycolor,c.hiddenentityfillcolor,c.hiddenentityalpha||c.hiddenentityfillalpha?m:"ffffff"),hiddenEntityAlpha:Object(s.Ib)(c.hiddenentityalpha,c.hiddenentityfillalpha,.001),shadow:Object(s.Kb)(c.showshadow,i.defaultPlotShadow,d.shadow)},t.markerOpts={dataLabels:{style:{fontFamily:Object(s.Ib)(c.markerfont,r),fontSize:Object(s.Kb)(c.markerfontsize,parseInt(a,10)),fontColor:Object(s.Ib)(c.markerfontcolor,o)}},showTooltip:Object(s.Kb)(c.showmarkertooltip,c.showtooltip,1),showLabels:Object(s.Kb)(c.showmarkerlabels,c.showlabels,1),showHoverEffect:Object(s.Kb)(c.showmarkerhovereffect,1),labelPadding:Object(s.Ib)(c.markerlabelpadding,"5"),labelWrapWidth:Object(s.Kb)(c.markerlabelwrapwidth,0),labelWrapHeight:Object(s.Kb)(c.markerlabelwrapheight,0),fillColor:Object(s.Ib)(c.markerfillcolor,c.markerbgcolor,d.markerfillcolor),fillAlpha:Object(s.Ib)(c.markerfillalpha,d.markerfillalpha),fillAngle:Object(s.Ib)(c.markerfillangle,d.markerfillangle),fillRatio:Object(s.Ib)(c.markerfillratio,d.markerfillratio),fillPattern:Object(s.Ib)(c.markerfillpattern,d.markerbgpattern),hoverFillColor:c.markerfillhovercolor,hoverFillAlpha:c.markerfillhoveralpha,hoverFillRatio:c.markerfillhoverratio,hoverFillAngle:c.markerfillhoverangle,borderThickness:Object(s.Ib)(c.markerborderthickness,1),borderColor:Object(s.Ib)(c.markerbordercolor,d.markerbordercolor),borderAlpha:Object(s.Kb)(c.markerborderalpha,d.markerborderalpha),hoverBorderThickness:c.markerborderhoverthickness,hoverBorderColor:c.markerborderhovercolor,hoverBorderAlpha:c.markerborderhoveralpha,radius:Object(s.Kb)(c.markerradius&&Object(s.Xb)(c.markerradius),7),shapeId:Object(s.Ib)(c.defaultmarkershape,St),labelSepChar:Object(s.Ib)(c.labelsepchar,At),tooltipSepChar:Object(s.Ib)(c.tooltipsepchar,", "),autoScale:Object(s.Kb)(c.autoscalemarkers,0),tooltext:Object(s.Ib)(h&&h.tooltext,c.markertooltext),dataEnabled:v,valueToRadius:Object(s.Kb)(c.markerradiusfromvalue,1),valueMarkerAlpha:Object(s.Ib)(c.valuemarkeralpha,"75"),hideNull:Object(s.Kb)(c.hidenullmarkers,0),nullRadius:Object(s.Kb)(c.nullmarkerradius,c.markerradius,7),adjustViewPort:Object(s.Kb)(c.adjustviewportformarkers,0),startAngle:Object(s.Kb)(c.markerstartangle,90),maxRadius:Object(s.Kb)(c.maxmarkerradius,0),minRadius:Object(s.Kb)(c.minmarkerradius,0),applyAll:Object(s.Kb)(c.applyallmarkers,0),shadow:Object(s.Kb)(c.showmarkershadow,c.showshadow,0)},t.connectorOpts={showHoverEffect:Object(s.Kb)(c.showconnectorhovereffect,1),thickness:Object(s.Kb)(c.connectorthickness,c.markerconnthickness,"2"),color:Object(s.Ib)(c.connectorcolor,c.markerconncolor,d.markerbordercolor),alpha:Object(s.Ib)(c.connectoralpha,c.markerconnalpha,"100"),hoverThickness:Object(s.Kb)(c.connectorhoverthickness,c.connectorthickness,c.markerconnthickness,"2"),hoverColor:Object(s.Ib)(c.connectorhovercolor,c.connectorcolor,c.markerconncolor,d.markerbordercolor),hoverAlpha:Object(s.Ib)(c.connectorhoveralpha,c.connectoralpha,c.markerconnalpha,"100"),dashed:Object(s.Kb)(c.connectordashed,c.markerconndashed,0),dashLen:Object(s.Kb)(c.connectordashlen,c.markerconndashlen,3),dashGap:Object(s.Kb)(c.connectordashgap,c.markerconndashgap,2),font:Object(s.Ib)(c.connectorfont,c.markerconnfont,r),fontColor:Object(s.Ib)(c.connectorfontcolor,c.markerconnfontcolor,o),fontSize:Object(s.Kb)(c.connectorfontsize,c.markerconnfontsize,parseInt(a,10)),showLabels:Object(s.Kb)(c.showconnectorlabels,c.showmarkerlabels,c.showlabels,1),labelBgColor:Object(s.Ib)(c.connectorlabelbgcolor,c.markerconnlabelbgcolor,d.plotfillcolor),labelBorderColor:Object(s.Ib)(c.connectorlabelbordercolor,c.markerconnlabelbordercolor,d.markerbordercolor),shadow:Object(s.Kb)(c.showconnectorshadow,c.showmarkershadow,c.showshadow,0),showTooltip:Object(s.Kb)(c.showconnectortooltip,c.showmarkertooltip,c.showtooltip,1),tooltext:Object(s.Ib)(h&&h.connectortooltext,c.connectortooltext),hideOpen:Object(s.Kb)(c.hideopenconnectors,1)},t.adjustViewPortForMarkers=Object(s.Kb)(c.adjustviewportformarkers,v)}_attachMouseEvents(){let e=this,t=e.getFromEnv("eventListeners"),o=e.getFromEnv("chart-container");t.push(i.a.listen(o,s.ub?"touchstart":"click",Mt.searchMouseMove,e)),t.push(i.a.listen(window.document,s.ub?"touchstart":"mousemove",Mt.searchMouseMove,e))}_dispose(){let e=this.getFromEnv("chart-container");s.ub&&(i.a.unlisten(e,"touchstart",Mt.searchMouseMove),i.a.unlisten(window.document,"touchstart",Mt.searchMouseMove)),i.a.unlisten(e,"click",Mt.searchMouseMove),i.a.unlisten(window.document,"mousemove",Mt.searchMouseMove),super._dispose()}static searchMouseMove(e){let t,o=e.data,r=o.config,a=o.getDatasets()[1],n=a&&a.getFromEnv("toolTipController"),i=a&&a.config.currentToolTip,l=o.config.lastHoveredPoint;o.getFromEnv("chart-container")&&o.config.lastInteractionEvent!==e.originalEvent&&(o.config.lastInteractionEvent=e.originalEvent,(t=Tt(e,o))&&t.insideCanvas?(r.lastMouseEvent=e,o._searchNearestNeighbour({x:t.chartX,y:t.chartY},e)):(l&&a&&a.hoverOutFn.call(l.element),o.config.lastHoveredPoint=null,n&&n.hide(i)))}_searchNearestNeighbour(e,t){let o,r=this.getDatasets()[1];if(r){if(!r.components.kDTree)return;o=r.getElement(e),r.highlightPoint(o||!1,t)}}_createLayers(){super._createLayers(),this._attachMouseEvents()}_parseBackgroundCosmetics(){let e,t=this,o=t.getChildren("background")[0].config,r=t.getChildren("colorPalette")[0],a=t.getFromEnv("chart-attrib");e=o.showBorder=Object(s.Kb)(a.showcanvasborder,1),o.borderWidth=e?Object(s.Kb)(a.canvasborderthickness,1):0,o.borderRadius=o.borderRadius=Object(s.Kb)(a.canvasborderradius,0),o.borderDashStyle=o.borderDashStyle=Object(s.Kb)(a.borderdashed,0)?Object(s.db)(Object(s.Kb)(a.borderdashlen,4),Object(s.Kb)(a.borderdashgap,2)):jt,o.borderAlpha=Object(s.Ib)(a.canvasborderalpha,r.borderAlpha),o.borderColor=o.borderColor=Object(s.P)(Object(s.Ib)(a.canvasbordercolor,r&&r.borderColor),o.borderAlpha)}_getBackgroundCosmetics(){let e=this,t=e.getFromEnv("chart-attrib")||e.jsonData.map,o=e.getChildren("colorPalette")[0];return{FCcolor:{color:Object(s.Ib)(t.bgcolor,t.canvasbgcolor,o.bgcolor),alpha:Object(s.Ib)(t.bgalpha,t.canvasbgalpha,o.bgalpha),angle:Object(s.Ib)(t.bgangle,t.canvasbgangle,o.bgangle),ratio:Object(s.Ib)(t.bgratio,t.canvasbgratio,o.bgratio)}}}_parseCanvasCosmetics(){super._parseCanvasCosmetics();let e=this,t=e.config,o=e.getFromEnv("chart-attrib")||e.jsonData.map,r=e.getChildren("canvas")[0].config;t.origMarginTop=Object(s.Kb)(o.maptopmargin,11),t.origMarginLeft=Object(s.Kb)(o.mapleftmargin,11),t.origMarginBottom=Object(s.Kb)(o.mapbottommargin,11),t.origMarginRight=Object(s.Kb)(o.maprightmargin,11),t.origCanvasLeftMargin=Object(s.Kb)(o.canvasleftmargin,0),t.origCanvasRightMargin=Object(s.Kb)(o.canvasrightmargin,0),t.origCanvasTopMargin=Object(s.Kb)(o.canvastopmargin,0),t.origCanvasBottomMargin=Object(s.Kb)(o.canvasbottommargin,0),r.canvasBorderRadius=Object(s.Kb)(o.canvasborderradius,0),r.origCanvasTopPad=Object(s.Kb)(o.canvastoppadding,0),r.origCanvasBottomPad=Object(s.Kb)(o.canvasbottompadding,0),r.origCanvasLeftPad=Object(s.Kb)(o.canvasleftpadding,0),r.origCanvasRightPad=Object(s.Kb)(o.canvasrightpadding,0)}preliminaryScaling(){let e,t,o,r=this.jsonData,a=r.markers&&r.markers.items||[],n=a&&a.length||0,i=1/0,l=1/0,s=-1/0,c=-1/0;for(;n--;)t=+(o=a[n]).y,i=_t(i,e=+o.x),l=_t(l,t),s=Pt(s,e),c=Pt(c,t);return{x:i,y:l,x1:s,y1:c}}getScalingParameters(e,t,o,r){let a,n,i=e/t,l=o/(e*this.config.baseScaleFactor),s=r/(t*this.config.baseScaleFactor),c=0,h=0;return l>s?(c+=(o-r*i)/2,n=200/(t*(a=s))):(h+=(r-o/i)/2,n=200/(e*(a=l))),{scaleFactor:a,strokeWidth:n,translateX:c,translateY:h}}calculateMarkerBounds(e,t,o){let r,a,n,i,l,s,c,h,d,g,p,b,u,f,m=this,v=m.config,y=v.markerOpts,C=m.getDatasets(),x=m.getDataLimits(),O=x.dataMin,k=x.dataMax,w=y.hideNull,F=y.nullRadius,j=y.valueToRadius,A=1/0,I=1/0,L=-1/0,S=-1/0;for(s=0,d=C.length;s<d;s++)"markers"===(c=(h=C[s]).getName())&&(r=h);if(r)for(s in r.calculateMarkerRadiusLimits(),n=(a=r.config||{}).minRadius,i=a.maxRadius,l=r.components&&r.components.markerObjs||{})u=(v=(f=l[s]).config).definition||{},null!==v.cleanValue?(j&&u.radius===xt&&(v.radius=n+(i-n)*(v.cleanValue-O)/(k-O)),p=(+u.y+o)*e,A=_t(A,(g=(+u.x+t)*e)-(b=+v.radius)),I=_t(I,p-b),L=Pt(L,g+b),S=Pt(S,p+b)):w?v.__hideMarker=!0:null===v.radius&&(v.radius=F);return{x:A,y:I,x1:L,y1:S}}_spaceManager(){let e,t,o,r,a,n,i,l,c,h=this,d=h.config,g=h.getChildren("legend")&&h.getChildren("legend")[0],p=g&&g.config.legendPos,b=h.getFromEnv("chart-attrib"),u=d.origMarginLeft,f=d.origMarginTop,m=h.config.baseWidth,v=h.config.baseHeight,y={},C=0,x=0,O=d.markerOpts,k=d.borderWidth=d.showBorder?Object(s.Kb)(b.borderthickness,1):0;h._allocateSpace({top:k,bottom:k,left:k,right:k}),h._allocateSpace(h._manageActionBarSpace&&h._manageActionBarSpace(.225*d.availableHeight)||{}),d.showLegend&&h._manageLegendSpace(l="right"===p?.3*d.canvasWidth:.3*d.canvasHeight),c=h._manageChartMenuBar(e=p===Lt?.225*d.canvasHeight:.225*d.canvasWidth),o=d.canvasWidth,r=d.canvasHeight,O.dataEnabled?(d.adjustViewPortForMarkers?((y=h.preliminaryScaling()).x1>m&&(m=y.x1),0>y.x&&(m+=-y.x,C=-y.x),y.y1>v&&(v=y.y1),0>y.y&&(v+=-y.y,x=-y.y),t=h.getScalingParameters(m,v,o,r),n=r,i=o,0>(y=h.calculateMarkerBounds(t.scaleFactor*h.config.baseScaleFactor,C,x)).x&&(u+=-y.x,o+=y.x),0>y.y&&(f+=-y.y,r+=y.y),y.x1>i&&(o-=y.x1-i),y.y1>n&&(r-=y.y1-n)):(t=h.getScalingParameters(m,v,o,r),h.calculateMarkerBounds(t.scaleFactor*h.config.baseScaleFactor,C,x)),u+=C*(t=h.getScalingParameters(m,v,o,r)).scaleFactor*h.config.baseScaleFactor,f+=x*t.scaleFactor*h.config.baseScaleFactor):t=h.getScalingParameters(m,v,o,r),h.config.scalingParams=t,a=t.scaleFactor,t.translateX+=u,t.translateY=t.translateY+f+c.top||0,t.sFactor=a*h.config.baseScaleFactor*100/100,t.transformStr=["t",t.translateX,",",t.translateY,"s",a,",",a,",0,0"].join(""),h.config.annotationConfig={id:"Geo",showbelow:0,autoscale:0,grpxshift:t.translateX?t.translateX:0,grpyshift:t.translateY?t.translateY:0,xscale:100*(a?a*h.config.baseScaleFactor:1),yscale:100*(a?a*h.config.baseScaleFactor:1),scaletext:1,options:{useTracker:!0}}}getDataLimits(){let e,t,o,r=this.getDatasets(),a=r.length,n=1/0,i=-1/0;for(o=0;o<a;o++)t=(e=r[o]).getDataLimits(),n=_t(n,t.min),i=Pt(i,t.max);return{dataMin:n,dataMax:i}}getEntityPaths(e){let t,o={},r=this.config.entities;if(e){for(t in r)o[t]=r[t];return o}return r}checkComplete(){let e=this;e.config.entityFlag&&e.config.entitiesReady&&(e.config.entityFlag=!1,e.config.markersDrawn=!0,e.fireChartInstanceEvent("internal.mapdrawingcomplete",{renderer:e}))}}var Bt=Mt;o.d(t,"Maps",function(){return Bt}),t.default={name:"maps",type:"package",requiresFusionCharts:!0,extension:e=>e.addDep(Bt)}}}]);